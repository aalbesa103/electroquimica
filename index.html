<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Electrólisis: Forzando Reacciones Químicas No Espontáneas</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- KaTeX for Math Formulas -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

  <style>
    html { scroll-behavior: smooth; }
    body { font-family: 'Roboto', sans-serif; background: linear-gradient(135deg, #1a3a8f 0%, #092056 100%); color: white; line-height: 1.6; }
    h1, h2, h3, h4 { font-family: 'Montserrat', sans-serif; color: #e0f2f7; }
    .section { min-height: 100vh; padding: 4rem 2rem; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
    .section-content { max-width: 1200px; width: 100%; text-align: left; }

    /* --- Diagram Styles --- */
    .cell-diagram-container { position: relative; width: 100%; max-width: 450px; /* Slightly wider for two cells */ height: 300px; /* Taller */ margin: 20px auto; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(0, 20, 60, 0.4); overflow: hidden; }

    /* Galvanic Cell Specific Styles */
    .galvanic .half-cell {
        position: absolute;
        bottom: 20px; /* Positioned at the bottom */
        width: 40%; /* Width of each beaker */
        height: 200px; /* Height of beaker */
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-bottom-left-radius: 10px;
        border-bottom-right-radius: 10px;
        overflow: hidden;
    }
    .galvanic .half-cell.left { left: 5%; }
    .galvanic .half-cell.right { right: 5%; }

    .galvanic .solution-area {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 160px; /* Solution level */
        opacity: 0.3;
    }
    .galvanic .anode-solution { background-color: #a0aec0; } /* Lighter color for ZnSO4 */
    .galvanic .cathode-solution { background-color: #63b3ed; } /* Bluer color for CuSO4 */

    .galvanic .electrode {
        position: absolute;
        bottom: 0; /* Inside the half-cell */
        left: 50%;
        transform: translateX(-50%);
        width: 15px;
        height: 180px; /* Electrode height */
        background: #b0b0b0; /* Default electrode color */
        border-radius: 3px 3px 0 0;
        display: flex;
        justify-content: flex-start; /* Label at the top */
        align-items: center;
        padding-top: 5px;
        font-size: 0.7rem;
        color: #1a202c;
        font-weight: bold;
        z-index: 10;
    }
    .galvanic .anode-galvanic { background-color: #718096; } /* Zinc color */
    .galvanic .cathode-galvanic { background-color: #e53e3e; } /* Copper color (using red for contrast) */

    .galvanic .salt-bridge {
        position: absolute;
        left: 25%; /* Start position */
        top: 90px; /* Position between beakers, above solution */
        width: 50%; /* Span between centers */
        height: 30px; /* Thickness */
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.4);
        border-radius: 15px; /* Rounded tube */
        z-index: 5;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 0.7rem;
        color: #e0f2f7;
    }
    /* Simple "plugs" for the salt bridge visually entering the solution */
    .galvanic .salt-bridge::before, .galvanic .salt-bridge::after {
        content: '';
        position: absolute;
        bottom: -15px; /* Extend downwards */
        width: 8px;
        height: 20px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.4);
        border-top: none;
         border-radius: 0 0 5px 5px;
    }
    .galvanic .salt-bridge::before { left: 10px; } /* Left plug */
    .galvanic .salt-bridge::after { right: 10px; } /* Right plug */
    /* --- Bubble Styles --- */
    .bubbles {
        position: absolute;
        top: 0; /* Position at the top of the electrode visual area */
        left: 0;
        width: 100%;
        height: 100%; /* Cover the whole electrode visual height */
        pointer-events: none; /* Allow clicks to pass through */
        z-index: 11; /* Slightly above mass/gas visuals */
        /* Initial state: hidden */
        opacity: 0;
        transition: opacity 0.3s ease-out; /* Smooth transition for visibility */

        /* Animation effect using background */
        background: radial-gradient(circle, rgba(173, 216, 230, 0.6) 0%, rgba(173, 216, 230, 0) 60%); /* Light blue gradient bubble */
        background-size: 30px 60px; /* Size of the repeating bubble effect */
        background-repeat: repeat-y; /* Repeat vertically */
         background-position: 50% 100%; /* Start animation from the bottom */
        animation: bubble-flow 3s linear infinite paused; /* Animation paused by default */
    }

    /* State when gas is produced */
    .bubbles.is-gassing {
        opacity: 1; /* Make bubbles visible */
        animation-play-state: running; /* Start the animation */
    }

    /* Animation Keyframes */
    @keyframes bubble-flow {
        0% { background-position: 50% 100%; opacity: 0.8; } /* Start large/visible at bottom */
        50% { opacity: 0.4; }
        100% { background-position: 50% 0%; opacity: 0; } /* Move to top and fade out */
    }

    /* Adjusting wires and electron flow for Galvanic */
    .galvanic .connection-wire {
        position: absolute;
        height: 2px;
        background: #a0aec0;
        top: 60px; /* Connect to voltmeter level */
        z-index: 15;
    }
    .galvanic .wire-galvanic-left {
        left: calc(5% + 20% - 7.5px); /* Center of left electrode */
        width: calc(50% - (5% + 20%) - 30px + 7.5px); /* To center minus half voltmeter */
    }
     .galvanic .wire-galvanic-right {
        right: calc(5% + 20% - 7.5px); /* Center of right electrode */
        width: calc(50% - (5% + 20%) - 30px + 7.5px); /* To center minus half voltmeter */
    }
     .galvanic .power-source.voltmeter {
        top: 45px; /* Position voltmeter */
        z-index: 20;
     }
     .galvanic .electron-flow-galvanic {
        position: absolute;
        top: 59px; /* Align with wire */
        left: calc(5% + 20%); /* Start from anode */
        width: calc(100% - 2 * (5% + 20%)); /* Span between electrodes */
        height: 2px;
        z-index: 16;
    }
     /* Ion positioning and animation for Galvanic */
     .galvanic .ion.cation.cu { /* Cu2+ */
         left: 70%; bottom: 60px; background: #3b82f6; /* Blue */
         animation: moveIonToCathodeGalv 5s infinite linear alternate;
     }
     .galvanic .ion.anion.so4 { /* SO4 2- in anode side */
         left: 20%; bottom: 80px; background: #f56565; /* Reddish */
         /* Stays relatively still or moves slightly away */
     }
     .galvanic .ion.cation.k { /* K+ from salt bridge */
         left: 60%; bottom: 125px; background: #9f7aea; /* Purple */
          animation: moveIonFromBridgeToCathode 6s infinite linear;
     }
      .galvanic .ion.anion.cl { /* Cl- from salt bridge */
         left: 40%; bottom: 125px; background: #48bb78; /* Green */
         animation: moveIonFromBridgeToAnode 6s infinite linear;
     }

    @keyframes moveIonToCathodeGalv { 0% {transform: translateX(-10px);} 100% {transform: translateX(15px);} } /* Cu towards cathode */
    @keyframes moveIonFromBridgeToCathode { 0% {transform: translateY(0) translateX(0);} 100% {transform: translateY(30px) translateX(30px);} } /* K+ out of bridge towards cathode */
    @keyframes moveIonFromBridgeToAnode { 0% {transform: translateY(0) translateX(0);} 100% {transform: translateY(30px) translateX(-30px);} } /* Cl- out of bridge towards anode */


    /* Electrolytic Cell Styles (Mostly Unchanged) */
    .electrolytic .electrode { position: absolute; width: 15px; height: 150px; bottom: 0; background: #d1d5db; border-radius: 3px; }
    .electrolytic .anode { left: 80px; background-color: #ef4444; }
    .electrolytic .cathode { right: 80px; background-color: #3b82f6; }
    .electrolytic .solution { position: absolute; bottom: 0; left: 0; width: 100%; height: 180px; background: rgba(59, 130, 246, 0.15); border-top: 1px solid rgba(255, 255, 255, 0.2); }
    .electrolytic .power-source.battery { top: 15px; background: #f59e0b; }
    .electrolytic .connection-wire { top: 45px; height: 2px; background: #a0aec0; } /* Adjusted top */
    .electrolytic .wire-elect-left { left: 80px; width: calc(50% - 80px - 30px); }
    .electrolytic .wire-elect-right { right: 80px; width: calc(50% - 80px - 30px); }
    .electrolytic .electron-flow-elect { position: absolute; top: 44px; left: 80px; width: calc(100% - 160px); height: 2px; }
    .electrolytic .ion.cation.na { left: 260px; bottom: 80px; background: #3b82f6; animation: moveCationToCathodeElectro 4s infinite linear alternate; }
    .electrolytic .ion.anion.cl { left: 120px; bottom: 120px; background: #ef4444; animation: moveAnionToAnodeElectro 4s infinite linear alternate; }

    /* Faraday Diagram Styles (Unchanged) */
    .faraday-diagram { position: relative; width: 100%; max-width: 600px; height: 350px; /* Increased height */ margin: 20px auto; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(0, 20, 60, 0.4); overflow: hidden; display: flex; justify-content: space-around; align-items: flex-end; padding-bottom: 10px; }
    .faraday-electrode { width: 20px; height: 150px; background-color: #d1d5db; position: relative; border-radius: 3px; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; font-size: 0.8rem; color: #333; font-weight: bold; padding-bottom: 5px; box-shadow: inset 0 0 5px rgba(0,0,0,0.3); }
    .faraday-solution { position: absolute; bottom: 0; left: 0; width: 100%; height: 200px; background: rgba(59, 130, 246, 0.15); border-top: 1px solid rgba(255, 255, 255, 0.2); }
        .dissolved-mass {
        position: absolute;
        top: 0; /* Position at the top */
        left: 0;
        width: 100%;
        background-color: rgba(255, 165, 0, 0.6); /* Orangeish, semi-transparent */
        height: 0; /* Starts at 0 height */
        transform-origin: top center; /* Grow from the top */
        transition: height 0.3s ease-out;
        border-radius: 0 0 3px 3px; /* Rounded bottom */
        z-index: 10;
    }
    .deposited-mass { position: absolute; bottom: 0; left: 0; width: 100%; background-color: #facc15; height: 0; transform-origin: bottom center; transition: height 0.3s ease-out; border-radius: 3px 3px 0 0; z-index: 10; }
    .gas-produced { position: absolute; top: 0; left: 0; width: 100%; background-color: rgba(16, 185, 129, 0.6); height: 0; transform-origin: top center; transition: height 0.3s ease-out; border-radius: 0 0 3px 3px; z-index: 10; }
    .faraday-electrode span { position: absolute; bottom: 10px; /* Moved label upwards */ width: 100px; text-align: center; font-size: 0.9rem; color: #e0f2f7; }


    /* Industrial Diagram Styles (CSS Based - Kept from previous) */
    .industrial-diagram-container { position: relative; width: 100%; max-width: 800px; height: 500px; margin: 20px auto; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(0, 20, 60, 0.5); overflow: hidden; box-shadow: 0 0 15px rgba(0, 0, 0, 0.5); }
    .diagram-element { position: absolute; background-color: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.4); border-radius: 5px; color: white; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; text-align: center; padding: 6px 10px; box-sizing: border-box; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); z-index: 5; }
    .electrode-ind { background-color: #9ca3af; border-color: #6b7280; width: 20px; height: 60%; writing-mode: vertical-rl; text-orientation: mixed; padding: 10px 5px; font-size: 0.75rem; }
    .anode-ind { background-color: rgba(239, 68, 68, 0.4); border-color: #ef4444; }
    .cathode-ind { background-color: rgba(59, 130, 246, 0.4); border-color: #3b82f6; }
    .tank { background-color: rgba(59, 130, 246, 0.15); border: 2px dashed rgba(59, 130, 246, 0.5); z-index: 1; }
    .membrane { background-color: rgba(236, 72, 153, 0.3); border: 1px solid #ec4899; width: 8px; height: 70%; z-index: 3; }
    .process-stream { position: absolute; background-color: rgba(192, 192, 192, 0.6); height: 3px; width: auto; z-index: 2; }
    .process-stream.vertical { width: 3px; height: auto; }
    .stream-arrow { position: absolute; width: 0; height: 0; border: 6px solid transparent; z-index: 2; }
    .arrow-right { border-left-color: rgba(192, 192, 192, 0.8); right: -11px; top: 50%; transform: translateY(-50%); }
    .arrow-left { border-right-color: rgba(192, 192, 192, 0.8); left: -11px; top: 50%; transform: translateY(-50%); }
    .arrow-down { border-top-color: rgba(192, 192, 192, 0.8); bottom: -11px; left: 50%; transform: translateX(-50%); }
    .arrow-up { border-bottom-color: rgba(192, 192, 192, 0.8); top: -11px; left: 50%; transform: translateX(-50%); }
    .input-label { background-color: rgba(139, 92, 246, 0.3); border-color: #8b5cf6; }
    .output-label { background-color: rgba(16, 185, 129, 0.3); border-color: #10b981; }
    .sludge-label { background-color: rgba(113, 63, 18, 0.5); border-color: #713f12; }
    .reaction-label { position: absolute; font-size: 0.7rem; color: #cbd5e1; z-index: 6; }
    .reaction-label-faraday {
        position: absolute;
        font-size: 0.9rem; /* Slightly larger than industrial diagram labels */
        color: #e0f2f7; /* Light blue color */
        background: rgba(0, 0, 0, 0.4); /* Semi-transparent background */
        padding: 5px 10px;
        border-radius: 5px;
        z-index: 6; /* Above diagram elements but below controls */
        text-align: center;
        width: 120px; /* Give it a fixed width */
    }
    /* General styles (key-point, calculation-steps, etc. - unchanged) */
    .key-point { display: flex; align-items: flex-start; margin-bottom: 1.5rem; }
    .key-point .icon { flex-shrink: 0; width: 30px; height: 30px; background: rgba(56, 182, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 1rem; color: #38bdf8; }
    .key-point p { flex-grow: 1; color: #e0f2f7; }
    .highlight { color: #60a5fa; font-weight: 600; }
    .highlight-orange { color: #fbbf24; font-weight: 600; }
    .highlight-green { color: #34d399; font-weight: 600; }
    .calculation-steps { margin-top: 1rem; padding: 1.5rem; background: rgba(0, 0, 0, 0.3); border-radius: 8px; text-align: left; font-size: 0.9rem; color: #e0f2f7; display: none; border: 1px solid rgba(255, 255, 255, 0.2); }
    .calculation-steps pre { white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New', Courier, monospace; background-color: rgba(0, 0, 0, 0.2); padding: 1rem; border-radius: 5px; }
    .calculation-steps h4 { margin-bottom: 1rem; color: #93c5fd; }
    .interactive-controls { margin-top: 20px; background: rgba(0, 0, 0, 0.2); padding: 20px; border-radius: 8px; display: flex; flex-direction: column; gap: 15px; border: 1px solid rgba(255, 255, 255, 0.2); }
    .control-group { display: flex; flex-direction: column; width: 100%; }
    .interactive-controls label { margin-bottom: 5px; color: #e0f2f7; font-size: 0.9rem; }
    .interactive-controls input[type="number"], .interactive-controls select { padding: 8px; border-radius: 4px; border: 1px solid #3b82f6; background-color: #071a40; color: white; width: 100%; }
    .interactive-controls button { padding: 10px 20px; background-color: #3b82f6; color: white; border-radius: 4px; cursor: pointer; transition: background-color 0.3s ease; align-self: center; }
    .interactive-controls button:hover { background-color: #2563eb; }
    .output-display { margin-top: 15px; padding: 10px; background: rgba(0, 0, 0, 0.3); border-radius: 5px; text-align: center; }
    .output-display p { margin-bottom: 5px; color: #e0f2f7; font-size: 1rem; }
    .output-display span { font-weight: bold; color: #facc15; }
    .interactive-controls input[type="range"] { -webkit-appearance: none; appearance: none; height: 8px; background: #374151; outline: none; opacity: 0.9; transition: opacity 0.2s; border-radius: 5px; cursor: pointer; width: 100%; border: 1px solid #4b5563; }
    .interactive-controls input[type="range"]:hover { opacity: 1; }
    .interactive-controls input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 20px; height: 20px; background: #3b82f6; cursor: pointer; border-radius: 50%; border: 2px solid #1d4ed8; box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
    .interactive-controls input[type="range"]::-moz-range-thumb { width: 20px; height: 20px; background: #3b82f6; cursor: pointer; border-radius: 50%; border: 2px solid #1d4ed8; box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
    .interactive-controls label span { font-weight: bold; color: #facc15; margin-left: 5px; }
    .comparison-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
    .comparison-item { background: rgba(0, 0, 0, 0.25); padding: 1.5rem; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.2); transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .comparison-item:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4); }
    .comparison-item h3 { color: #93c5fd; margin-bottom: 1rem; display: flex; align-items: center; }
    .comparison-item h3 i { margin-right: 0.75rem; color: #60a5fa; }
    .comparison-item ul { list-style: none; padding-left: 0; color: #e0f2f7; }
    .comparison-item li { margin-bottom: 0.5rem; position: relative; padding-left: 1.5rem; }
    .comparison-item li::before { content: "\f00c"; font-family: "Font Awesome 6 Free"; font-weight: 900; position: absolute; left: 0; color: #34d399; }
    .nav-button { margin-top: 3rem; padding: 0.75rem 2rem; background-color: #2563eb; color: white; text-decoration: none; border-radius: 9999px; font-weight: 500; transition: background-color 0.3s ease, transform 0.2s ease; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); }
    .nav-button:hover { background-color: #1d4ed8; transform: translateY(-2px); }
    .nav-button-container { margin-top: 4rem; display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap; }

  </style>
</head>
<body class="bg-gradient-blue">

  <!-- Slide 1: Title (No changes) -->
  <section id="title" class="section">
    <div class="section-content text-center">
        <h1 class="text-5xl md:text-6xl font-bold mb-4">Electrólisis: Forzando Reacciones Químicas No Espontáneas</h1>
        <h2 class="text-3xl md:text-4xl font-light text-blue-200 mb-12">Aplicaciones y Principios Cuantitativos</h2>
        <p class="text-xl mt-8 text-blue-100">Clase Interactiva</p>
        <p class="text-lg mt-2 text-blue-100">Fecha: <span id="current-date"></span></p>
        <div class="nav-button-container">
            <a href="intro-enigma"class="nav-button">Comenzar <i class="fas fa-arrow-right ml-2"></i></a>
        </div>
    </div>
  </section>
    <!-- Slide 2 (New): Story - The Enigma and The Challenge -->
    <section id="intro-enigma" class="section">
        <div class="section-content text-center">
            <h2 class="text-4xl font-bold mb-8 text-blue-300">El Enigma del Metal Oculto</h2>
            <h3 class="text-2xl font-semibold mb-6 text-blue-200">Abundante, Carísimo e Inalcanzable</h3>
            <div class="max-w-3xl mx-auto text-left text-lg">
                 <p class="mb-4"><span class="highlight">El Aluminio:</span> metal ligero, resistente, <span class="highlight-green">el más abundante</span> en la corteza terrestre.</p>
                 <p class="mb-4">Pero estaba <span class="highlight-orange">firmemente atrapado</span> en el óxido de aluminio (\( \text{Al}_2\text{O}_3 \)) con un punto de fusión <span class="highlight-orange">superior a \( 2000^\circ \text{C} \)</span>.</p>
                 <p class="mb-4">Era <span class="highlight-orange">imposible/carísimo</span> extraerlo de forma masiva. Era un metal más caro que el oro, usado solo en lujos.</p>
                 <p>En 1886, el joven <span class="highlight">Charles Hall</span> tomó el desafío de su profesor: "Quien descubra un método <span class="highlight-green">barato</span> para producir aluminio...". Su intuición: ¡la <span class="highlight">Electrólisis</span> era la clave! Pero, ¿cómo aplicarla a \( \text{Al}_2\text{O}_3 \) sin temperaturas extremas?</p>
            </div>
             <!-- Navigation Buttons -->
            <div class="nav-button-container">
                 <a href="#title" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Inicio</a>
                 <a href="#intro-solucion" class="nav-button">Siguiente <i class="fas fa-arrow-right ml-2"></i></a>
            </div>
        </div>
    </section>

    <!-- Slide 3 (New): Story - The Solution and Impact -->
    <section id="intro-solucion" class="section">
        <div class="section-content text-center">
            <h2 class="text-4xl font-bold mb-8 text-blue-300">La Llave Maestra y la Revolución</h2>
            <h3 class="text-2xl font-semibold mb-6 text-blue-200">El Proceso Hall-Héroult</h3>
             <div class="max-w-3xl mx-auto text-left text-lg">
                 <p class="mb-4">Hall encontró la <span class="highlight">solución genial</span>: usar <span class="highlight">Criolita</span> (\( \text{Na}_3\text{AlF}_6 \)) fundida.</p>
                 <div class="key-point"> <div class="icon"><i class="fas fa-gem"></i></div> <p>La Criolita funde a \( \sim 1000^\circ \text{C} \) y ¡ <span class="highlight-green">disuelve la Alúmina</span>, creando un baño conductor!</p> </div>
                 <p class="mb-4 mt-4">Aplicando <span class="highlight">electrólisis</span> al baño fundido:</p>
                 <div class="key-point"> <div class="icon"><i class="fas fa-bolt"></i></div> <p>En el <span class="highlight">Cátodo (-)</span>: <span class="highlight-green">Reducción</span> de \( \text{Al}^{3+} \to \text{Al}(l) \)</p> </div>
                 <p class="text-xl text-center mb-4">\( \text{Al}^{3+} + 3e^- \rightarrow \text{Al}(l) \)</p>
                  <p class="mb-4 text-center italic">(El francés Paul Héroult hizo el mismo descubrimiento ¡en el mismo año!).</p>
                  <p class="text-center mt-4 text-xl text-yellow-400">¡El <span class="highlight-green">Proceso Hall-Héroult</span> hizo caer el precio del aluminio, democratizándolo y transformando el mundo!</p>
            </div>
             <!-- Navigation Buttons -->
            <div class="nav-button-container">
                 <a href="#intro-enigma" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a>
                 <a href="#introduction" class="nav-button">Continuar: Fundamentos de la Electrólisis <i class="fas fa-arrow-right ml-2"></i></a>
            </div>
        </div>
    </section>
  <!-- Slide 2: Introduction (Diagrama Galvánico CORREGIDO) -->
  <section id="introduction" class="section">
    <div class="section-content">
      <h2 class="text-4xl font-bold mb-8 text-center">Introducción: Pilas Galvánicas vs Celdas Electrolíticas</h2>
      <div class="flex flex-col md:flex-row gap-12 items-start">
        <!-- Diagrams Side by Side -->

        <div class="w-full md:w-1/2 flex flex-col items-center">
            <h3 class="text-2xl font-semibold mb-4">Pila Galvánica (Espontánea)</h3>
            <!-- Diagrama de Pila Galvánica en GIF -->
            <img src="galvanica.gif" alt="Diagrama animado de Pila Galvánica" class="w-full max-w-md mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
            <p class="mt-2 text-blue-100 text-center text-xl">Reacción Redox <span class="highlight-green">Espontánea</span></p>

            <h3 class="text-2xl font-semibold mb-4 mt-10">Celda Electrolítica (No Espontánea)</h3>
             <!-- Diagrama de Celda Electrolítica en GIF -->
             <img src="electrolitica.gif" alt="Diagrama animado de Celda Electrolítica" class="w-full max-w-md mx-auto border border-blue-400 rounded-lg shadow-lg">
            <p class="mt-2 text-blue-100 text-center text-xl">Reacción Redox <span class="highlight-orange">No Espontánea</span></p>
        </div>
        <!-- Key Points (Increased font size) -->
        <div class="w-full md:w-1/2 mt-8 md:mt-0">
            <div class="key-point"> <div class="icon"><i class="fas fa-lightbulb"></i></div> <p class="text-xl">Las <span class="highlight">pilas galvánicas</span> usan reacciones <span class="highlight-green">espontáneas</span> para generar electricidad (requieren <span class="highlight">semiceldas separadas</span> y <span class="highlight">puente salino</span> usualmente).</p> </div>
            <div class="key-point"> <div class="icon"><i class="fas fa-plug"></i></div> <p class="text-xl">La <span class="highlight">electrólisis</span> usa electricidad <span class="highlight">externa</span> para forzar reacciones <span class="highlight-orange">no espontáneas</span> (a menudo en <span class="highlight">una sola cuba</span>).</p> </div>
            <div class="key-point"> <div class="icon"><i class="fas fa-exchange-alt"></i></div> <p class="text-xl">Convierte energía <span class="highlight-orange">eléctrica</span> <i class="fas fa-long-arrow-alt-right mx-1"></i> energía <span class="highlight-green">química</span>.</p> </div>
            <div class="key-point"> <div class="icon"><i class="fas fa-industry"></i></div> <p class="text-xl">Fundamental para obtener elementos/compuestos reactivos (Na, Cl₂, F₂, Al) o purificar metales (Cu, Zn).</p> </div>
            <div class="key-point"> <div class="icon"><i class="fas fa-sign"></i></div> <p class="text-xl"><span class="highlight-orange">¡Ojo con los signos!</span> Galvánica: Ánodo(-), Cátodo(+). Electrolítica: Ánodo(+), Cátodo(-). <br> <span class="highlight">Oxidación siempre en Ánodo</span>, <span class="highlight">Reducción siempre en Cátodo</span>.</p> </div>
        </div>
      </div>
       <div class="nav-button-container">
           <a href="#fundamentals" class="nav-button">Siguiente <i class="fas fa-arrow-right ml-2"></i></a>
       </div>
    </div>
  </section>

  <!-- Resto de las secciones (Fundamentals, Faraday Laws, Interactives, Exercises, Industrial Apps Overview, Industrial Diagrams (CSS based), Technical Aspects, Other Apps, Summary, Thank You) permanecen igual que en la versión anterior que eliminó Mermaid -->

   <!-- Slide 3: Fundamentals -->
   <section id="fundamentals" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
           <h2 class="text-4xl font-bold mb-8 text-center">Fundamentos Teóricos de la Celda Electrolítica</h2>
            <div class="flex flex-col md:flex-row gap-12 items-center">

                <div class="w-full md:w-1/2 flex justify-center">
                    <!-- Diagrama de Celda Electrolítica en Imagen -->
                    <img src="electrolisis-2.jpg" alt="" class="w-full max-w-md mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
                 </div>
                <div class="w-full md:w-1/2">
                    <!-- Key Points (Increased font size and improved formula display) -->
                    <div class="key-point"> <div class="icon"><i class="fas fa-power-off"></i></div> <p class="text-xl">Requiere fuente DC externa.</p> </div>
                    <div class="key-point"> <div class="icon"><i class="fas fa-link"></i></div> <p class="text-xl">Ánodo conectado al (+), Cátodo al (-).</p> </div>
                    <div class="key-point"> <div class="icon"><i class="fas fa-magnet"></i></div> <p class="text-xl">Cátodo (-): Atrae cationes (+), ocurre Reducción.</p> </div>
                     <div class="key-point"> <div class="icon"><i class="fas fa-magnet"></i></div> <p class="text-xl">Ánodo (+): Atrae aniones (-), ocurre Oxidación.</p> </div>
                     <div class="key-point"> <div class="icon"><i class="fas fa-tint"></i></div> <p class="text-xl">Electrolito permite movimiento de iones.</p> </div>
                     <div class="key-point"> <div class="icon"><i class="fas fa-bolt"></i></div> <p class="text-xl">Fuente "bombea" electrones.</p> </div>
                      <div class="key-point"> <div class="icon"><i class="fas fa-greater-than-equal"></i></div> <p class="text-xl">\[ V_{apl} \geq |-E_{celda}| + \eta + IR \] .</p> </div>
                </div>
            </div>
            <div class="nav-button-container"> <a href="#introduction" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a> <a href="#faraday-laws" class="nav-button">Siguiente <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
   </section>

   <!-- Slide 4: Faraday's Laws Theory -->
   <section id="faraday-laws" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Leyes Cuantitativas: Leyes de Faraday</h2>
            <p class="text-xl text-blue-100 mb-4 text-center">Principios que relacionan la cantidad de sustancia transformada con la cantidad de electricidad.</p>
            <!-- Punto 1 de la definición proporcionada -->
            <p class="text-lg text-blue-200 mb-12 text-center italic">Según Michael Faraday, la masa de un elemento transformada en una electrólisis es independiente de la composición química del electrolito, siempre que el estado de oxidación del elemento sea el mismo (ej: CuSO₄, Cu(NO₃)₂).</p>

            <div class="comparison-grid">
                 <div class="comparison-item">
                     <h3><i class="fas fa-chart-line"></i> Primera Ley</h3>
                     <p>La masa ($m$) de un elemento depositado o disuelto en un electrodo es directamente proporcional a la cantidad de electricidad ($Q$) que circuló en la celda. La constante de proporcionalidad es denominada equivalente electroquímico.</p>
                     <p class="text-center mt-2">\[ m \propto Q \]</p>
                     <div class="text-center mt-6"> <a href="#faraday-1-interactive" class="nav-button">Ver Interactivo</a> </div>
                 </div>
                 <div class="comparison-item">
                     <h3><i class="fas fa-balance-scale"></i> Segunda Ley</h3>
                     <p>Las masas de distintos elementos transformadas en un mismo circuito electrolítico son directamente proporcionales a sus pesos equivalentes químicos ($Eq = M/z$).</p>
                      <p class="text-center mt-2">\[ m \propto Eq \]</p>
                     <div class="text-center mt-6"> <a href="#faraday-2-interactive" class="nav-button">Ver Interactivo</a> </div>
                 </div>
                 <div class="comparison-item">
                     <h3><i class="fas fa-calculator"></i> Fórmula Combinada</h3>
                     <p>Combinando ambas leyes y sabiendo que \(Q = I \cdot t\), la masa ($m$) de sustancia transformada se calcula como:</p>
                     <p class="text-center mt-2">\[ m = \frac{M \cdot I \cdot t}{z \cdot F} \]</p>
                     <div class="text-center mt-6"> <a href="#faraday-3-interactive" class="nav-button">Ver Interactivo</a> </div>
                 </div>
            </div>
            <div class="bg-blue-900 bg-opacity-50 p-6 rounded-lg border mt-12 text-center max-w-md mx-auto">
               <h4 class="text-xl font-semibold mb-3">Constante de Faraday (F)</h4>
               <p>Carga de 1 mol de e⁻.</p>
               <p>\[ F \approx 96485 \text{ C/mol e}^- \]</p>
            </div>
            <div class="nav-button-container"> <a href="#fundamentals" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a> <a href="#faraday-1-interactive" class="nav-button">Interactivos Faraday <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
   </section>

   <!-- Slide 5: Interactive Faraday 1 -->
   <section id="faraday-1-interactive" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
            <h2 class="text-4xl font-bold mb-4 text-center">Interactiva: Primera Ley de Faraday</h2>
            <p class="text-xl text-blue-100 mb-8 text-center">\( m \propto Q \)</p>
            <div class="flex flex-col md:flex-row items-center gap-8">
                <div class="w-full md:w-1/2 flex justify-center">
                    <div class="faraday-diagram">
                        <div class="faraday-solution"></div>
                        <!-- Anode Electrode with Dissolved Mass -->
                        <div class="faraday-electrode" style="background-color: #ef4444; position: relative;">
                            <div id="dissolved-mass-1" class="dissolved-mass"></div> <!-- New div for dissolved part -->
                            <span>Ánodo (+)</span>
                            <!-- produced-gas-1 is kept but will not be used in JS for this example -->
                        </div>
                         <!-- Anode Reaction Label -->
                        <p class="reaction-label-faraday" style="top: 50px; left: 10%;">Ánodo (+): \( \text{Cu}(s) \rightarrow \text{Cu}^{2+} + 2e^- \) </p> <!-- ADD THIS LINE -->
                        <!-- Cathode Electrode with Deposited Mass -->
                        <div class="faraday-electrode" style="background-color: #3b82f6; position: relative;">
                             <div id="deposited-mass-1" class="deposited-mass"></div>
                             <span>Cátodo (-)</span>
                         </div>
                         <!-- Cathode Reaction Label -->
                        <p class="reaction-label-faraday" style="top: 50px; right: 10%;">Cátodo (-): \( \text{Cu}^{2+} + 2e^- \rightarrow \text{Cu}(s) \) </p> <!-- ADD THIS LINE -->
                        <div class="absolute top-4 left-4 text-sm text-white p-2 bg-black bg-opacity-50 rounded">Electrólisis de CuSO₄ con electrodos de Cu</div> <!-- This line was modified in Change 1 -->
                        <!-- produced-gas-1 is kept for potential other examples, but won't be used here -->
                        <div id="produced-gas-1" class="gas-produced" style="height:0;"></div>
                    </div>
                        <div class="absolute top-4 left-4 text-sm text-white p-2 bg-black bg-opacity-50 rounded">Electrólisis de CuSO₄ con electrodos de Cu</div>
                        <!-- produced-gas-1 is kept for potential other examples, but won't be used here -->
                        <div id="produced-gas-1" class="gas-produced" style="height:0;"></div>
                    </div>
                </div>
                <div class="w-full md:w-1/2">
                    <div class="interactive-controls">
                         <h4 class="text-xl font-semibold text-center mb-2 text-blue-300">Ajusta Parámetros</h4>
                         <div class="control-group"> <label for="current-1">Corriente (I): <span id="current-value-1">1.0</span> A</label> <input type="range" id="current-1" value="1.0" step="0.1" min="0.1" max="5.0" class="w-full"> </div>
                         <div class="control-group"> <label for="time-1">Tiempo (t): <span id="time-value-1">10.0</span> min</label> <input type="range" id="time-1" value="10.0" step="1.0" min="1.0" max="60.0" class="w-full"> </div>
                         <!-- New Voltage Control -->
                         <div class="control-group"> <label for="voltage-1">Voltaje Aplicado (V): <span id="voltage-value-1">0.0</span> V</label> <input type="range" id="voltage-1" value="0.0" step="0.1" min="0.0" max="5.0" class="w-full"> </div>
                         <div class="output-display">
                             <p>Carga (Q): <span id="charge-1">0</span> C</p>
                             <p>Masa Cu Depositada (Cátodo): <span id="mass-1">0</span> g</p>
                             <p>Masa Cu Disuelta (Ánodo): <span id="anode-mass-1">0</span> g</p> <!-- Display for anode mass lost -->
                         </div>
                    </div>
                     <p class="mt-4 text-center text-sm italic">Ajusta los sliders. Necesitas suficiente voltaje para iniciar la reacción.</p>
                </div>
            </div>
            <div class="nav-button-container"> <a href="#faraday-laws" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Volver Leyes</a> <a href="#faraday-2-interactive" class="nav-button">Siguiente Ley <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
   </section>

   <!-- Slide 6: Interactive Faraday 2 -->
   <section id="faraday-2-interactive" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
           <h2 class="text-4xl font-bold mb-4 text-center">Interactiva: Segunda Ley de Faraday</h2>
            <p class="text-xl text-blue-100 mb-4 text-center">Masa transformada proporcional al Peso Equivalente para una carga fija (1 Faraday).</p>
             <p class="text-lg text-blue-200 mb-8 text-center italic">Observa cómo cambian los productos en Ánodo y Cátodo al variar el electrolito y el material del ánodo.</p>

            <div class="flex flex-col md:flex-row items-start gap-8">
                 <div class="w-full md:w-1/2 flex justify-center">
                    <div class="faraday-diagram">
                         <div class="faraday-solution" style="height: 220px;"></div>
                         <!-- Anode Electrode -->
                         <div class="faraday-electrode" style="background-color: #ef4444; position: relative;">
                            <div id="dissolved-mass-2" class="dissolved-mass"></div>
                            <div id="produced-gas-2" class="produced-gas" style="height:0;"></div> <!-- Ensure this uses produced-gas class -->
                             <div id="anode-bubbles-2" class="bubbles"></div> <!-- NEW BUBBLE ELEMENT -->
                             <span>Ánodo (+)</span>
                         </div>
                         <!-- Anode Reaction Label -->
                         <p id="anode-reaction-2" class="reaction-label-faraday" style="top: 80px; left: 8%; width: 140px;">Ánodo (+): ... </p>

                        <!-- Cathode Electrode -->
                        <div class="faraday-electrode" style="background-color: #3b82f6; position: relative;">
                            <div id="deposited-mass-2" class="deposited-mass"></div>
                            <div id="cathode-bubbles-2" class="bubbles"></div> <!-- NEW BUBBLE ELEMENT -->
                             <span>Cátodo (-)</span>
                         </div>
                         <!-- Cathode Reaction Label -->
                         <p id="cathode-reaction-2" class="reaction-label-faraday" style="top: 80px; right: 8%; width: 140px;">Cátodo (-): ... </p>

                         <div class="absolute top-4 left-4 text-sm text-white p-2 bg-black bg-opacity-50 rounded">Carga Fija: 1 Faraday</div>
                    </div>
                </div>
                 <div class="w-full md:w-1/2">
                    <div class="interactive-controls">
                         <h4 class="text-xl font-semibold text-center mb-2 text-blue-300">Configura la Celda</h4>
                         <!-- Solution Select -->
                         <div class="control-group"> <label for="solution-select-2">Electrolito:</label> <select id="solution-select-2" class="w-full"> <option value="CuSO4" selected>Sulfato de Cobre (CuSO₄)</option> <option value="AgNO3">Nitrato de Plata (AgNO₃)</option> <option value="NaCl_conc">Cloruro de Sodio (NaCl Concentrado)</option> <option value="NaCl_dilute">Cloruro de Sodio (NaCl Diluido)</option> <option value="H2SO4">Ácido Sulfúrico (H₂SO₄ dil.)</option> </select> </div>
                         <!-- Anode Material Select -->
                          <div class="control-group"> <label for="anode-select-2">Material del Ánodo:</label> <select id="anode-select-2" class="w-full"> <option value="Cu">Cobre (Cu)</option> <option value="Inert">Inerte (Ej: Grafito, Pt)</option> </select> </div>
                         <!-- Cathode Material Select -->
                          <div class="control-group"> <label for="cathode-select-2">Material del Cátodo (Superficie):</label> <select id="cathode-select-2" class="w-full"> <option value="Cu">Cobre (Cu)</option> <option value="Al">Aluminio (Al)</option> <option value="Inert">Inerte</option> </select> </div>
                         <div class="output-display">
                              <p>Carga Circulada: <span>96485 C (1 F)</span></p> <!-- Updated Faraday value -->
                             <p>Cátodo: <span id="cathode-result-2">0</span> g</p> <!-- Changed label and id -->
                             <p>Ánodo: <span id="anode-result-2">0</span></p>
                         </div>
                    </div>
                     <p class="mt-4 text-center text-sm italic">Selecciona el electrolito y los materiales de los electrodos.</p>
                 </div>
            </div>
            <div class="nav-button-container"> <a href="#faraday-1-interactive" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Ley Anterior</a> <a href="#faraday-3-interactive" class="nav-button">Siguiente Ley <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
   </section>

   <!-- Slide 7: Interactive Faraday 3 -->
   <section id="faraday-3-interactive" class="section">
       <div class="section-content">
            <h2 class="text-4xl font-bold mb-4 text-center">Interactiva: Fórmula Combinada</h2>
            <p class="text-xl text-blue-100 mb-4 text-center">Calculadora de productos de electrólisis (\( m = \frac{M \cdot I \cdot t}{z \cdot F} \))</p>
             <p class="text-lg text-blue-200 mb-8 text-center italic">Calcula la cantidad de sustancia transformada ajustando los parámetros de la celda y la corriente.</p>

             <div class="flex flex-col md:flex-row items-start gap-8">
                 <div class="w-full md:w-1/2 flex flex-col items-center">
                    <div class="faraday-diagram">
                         <div class="faraday-solution" style="height: 200px;"></div> <!-- Match electrode height -->

                         <!-- Left Electrode (Anode Visuals) -->
                         <div class="faraday-electrode" style="background-color: #ef4444; position: relative;">
                            <div id="anode-dissolved-3" class="dissolved-mass"></div> <!-- Visual for dissolved mass -->
                            <div id="anode-gas-3" class="produced-gas" style="height:0;"></div> <!-- Visual for gas -->
                            <div id="anode-bubbles-3" class="bubbles"></div> <!-- BUBBLE ELEMENT -->
                             <span>Ánodo (+)</span>
                         </div>

                         <!-- Right Electrode (Cathode Visuals) -->
                         <div class="faraday-electrode" style="background-color: #3b82f6; position: relative;">
                             <div id="cathode-deposited-3" class="deposited-mass"></div> <!-- Visual for deposited mass -->
                             <div id="cathode-gas-3" class="produced-gas" style="height:0;"></div> <!-- Visual for gas -->
                             <div id="cathode-bubbles-3" class="bubbles"></div> <!-- BUBBLE ELEMENT -->
                             <span>Cátodo (-)</span>
                         </div>

                         <!-- Diagram Label -->
                         <div class="absolute top-4 left-4 text-sm text-white p-2 bg-black bg-opacity-50 rounded">Configura tu Electrólisis</div>
                    </div>
                    <!-- Reaction Labels below the diagram -->
                    <div class="w-full mt-8 text-sm">
                         <p id="anode-reaction-3" class="reaction-label-faraday" style="position: static; margin-bottom: 10px; width: 100%; text-align: center; background: none; border: none; padding: 0; color: #e0f2f7;"></p>
                         <p id="cathode-reaction-3" class="reaction-label-faraday" style="position: static; width: 100%; text-align: center; background: none; border: none; padding: 0; color: #e0f2f7;"></p>
                     </div>
                </div>

                 <div class="w-full md:w-1/2">
                     <div class="interactive-controls">
                         <h4 class="text-xl font-semibold text-center mb-2 text-blue-300">Ajusta Parámetros</h4>
                         <!-- Solution Select -->
                         <div class="control-group"> <label for="solution-select-3">Electrolito:</label> <select id="solution-select-3" class="w-full"> <option value="CuSO4" selected>Sulfato de Cobre (CuSO₄)</option> <option value="AgNO3">Nitrato de Plata (AgNO₃)</option> <option value="NaCl_conc">Cloruro de Sodio (NaCl Concentrado)</option> <option value="NaCl_dilute">Cloruro de Sodio (NaCl Diluido)</option> <option value="H2SO4">Ácido Sulfúrico (H₂SO₄ dil.)</option> </select> </div>
                         <!-- Anode Material Select -->
                          <div class="control-group"> <label for="anode-select-3">Material del Ánodo:</label> <select id="anode-select-3" class="w-full"> <option value="Cu">Cobre (Cu)</option> <option value="Inert">Inerte (Ej: Grafito, Pt)</option> </select> </div>
                         <!-- Cathode Material Select -->
                          <div class="control-group"> <label for="cathode-select-3">Material del Cátodo (Superficie):</label> <select id="cathode-select-3" class="w-full"> <option value="Cu">Cobre (Cu)</option> <option value="Al">Aluminio (Al)</option> <option value="Inert">Inerte</option> </select> </div>
                         <!-- Removed Voltage Control -->
                         <div class="control-group"> <label for="current-3">Corriente (I): <span id="current-value-3">5.0</span> A</label> <input type="range" id="current-3" value="5.0" step="0.5" min="0.5" max="20.0" class="w-full"> </div>
                         <div class="control-group"> <label for="time-3">Tiempo (t): <span id="time-value-3">1.0</span> h</label> <input type="range" id="time-3" value="1.0" step="0.1" min="0.1" max="5.0" class="w-full"> </div>

                         <div class="output-display">
                             <p>Cantidad Circulada: <span id="charge-3">0</span> C</p>
                             <p>Cátodo: <span id="cathode-result-3">0</span></p> <!-- Result value and unit -->
                             <p>Ánodo: <span id="anode-result-3">0</span></p> <!-- Result value and unit -->
                             <!-- Removed voltage requirement note -->
                         </div>
                     </div>
                      <p class="mt-4 text-center text-sm italic">Ajusta los parámetros de la celda, corriente y tiempo.</p> <!-- Updated instruction -->
                 </div>
             </div>
             <!-- Nav buttons now correctly inside the main section div -->
             <div class="nav-button-container"> <a href="#faraday-2-interactive" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Ley Anterior</a> <a href="#exercises" class="nav-button">Ejercicios <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div> <!-- Ends section-content -->
   </section>



    <!-- Slide 8: Exercises -->
   <section id="exercises" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
           <h2 class="text-4xl font-bold mb-8 text-center">Ejercicios de Aplicación</h2>
            <p class="text-xl text-blue-100 mb-12 text-center">Resolución de problemas cuantitativos.</p>
            <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border mb-8">
                 <h3 class="text-2xl font-semibold mb-4 text-blue-300">Ejercicio 1: Deposición Cu</h3>
                 <p>Calcular masa Cu (M=63.5) con 2.50 A por 50.0 min. Reac: \( \text{Cu}^{2+} + 2e^- \rightarrow \text{Cu}(s) \)</p>
                 <div class="text-center mt-4"> <button class="toggle-calculation px-6 py-2 bg-blue-600 rounded"><i class="fas fa-eye mr-2"></i>Cálculo</button> <div class="calculation-steps mt-4"><pre># Cálculo detallado (Ej. 1)

Corriente (I) = 2.50 A
Tiempo (t) = 50.0 min = 50.0 * 60 s = 3000 s
Carga (Q) = I * t = 2.50 A * 3000 s = 7500 C

Moles de electrones (n_e) = Q / F = 7500 C / 96485 C/mol e- ≈ 0.0777 mol e-

Reacción del Cátodo: Cu²⁺ + 2e⁻ → Cu(s)
Para 1 mol de Cu(s) se necesitan 2 moles de e⁻.
Relación estequiométrica: 1 mol Cu / 2 mol e⁻

Moles de Cu = n_e * (1 mol Cu / 2 mol e⁻) = 0.0777 mol e- * (1/2) ≈ 0.03885 mol Cu

Masa de Cu = moles Cu * Masa Molar Cu
Masa Molar Cu (M) = 63.5 g/mol

Masa de Cu = 0.03885 mol * 63.5 g/mol ≈ 2.467 g

Respuesta: ~2.47 g Cu</pre></div> </div>
             </div>
            <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border">
                 <h3 class="text-2xl font-semibold mb-4 text-blue-300">Ejercicio 2: Electrólisis Agua</h3>
                 <p>Calcular vol. total gas (H₂ y O₂) a TPE con 1.26 A por 7.44 h. Reac: \( 2H_2O \rightarrow 2H_2 + O_2 \)</p>
                 <div class="text-center mt-4"> <button class="toggle-calculation px-6 py-2 bg-blue-600 rounded"><i class="fas fa-eye mr-2"></i>Cálculo</button> <div class="calculation-steps mt-4"><pre># Cálculo detallado (usando Vm=24.79 L/mol @ 25°C, 1 bar - SATP para TPE)

Corriente (I) = 1.26 A
Tiempo (t) = 7.44 h = 7.44 * 3600 s = 26784 s
Carga (Q) = I * t = 1.26 A * 26784 s = 33748.8 C
Moles de electrones (n_e) = Q / F = 33748.8 C / 96485 C/mol e- ≈ 0.350 mol e-

Reacciones:
Cátodo: 2H₂O + 2e⁻ → H₂(g) + 2OH⁻  (z=2 para H₂ por mol)
Ánodo:  2H₂O → O₂(g) + 4H⁺ + 4e⁻   (z=4 para O₂ por mol)

Moles de H₂ = n_e / z_H₂ = 0.350 mol e- / 2 mol e⁻/mol H₂ ≈ 0.175 mol H₂
Volumen de H₂ = moles H₂ * Vm = 0.175 mol * 24.79 L/mol ≈ 4.334 L

Moles de O₂ = n_e / z_O₂ = 0.350 mol e- / 4 mol e⁻/mol O₂ ≈ 0.0875 mol O₂
Volumen de O₂ = moles O₂ * Vm = 0.0875 mol * 24.79 L/mol ≈ 2.167 L

Volumen total = Volumen H₂ + Volumen O₂ = 4.334 L + 2.167 L ≈ 6.501 L

Respuesta: 4.334 L H₂ + 2.167 L O₂ = 6.501 L Total</pre></div> </div>
            </div>
            <div class="nav-button-container"> <a href="#faraday-3-interactive" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Ley Anterior</a> <a href="#nacl-molten" class="nav-button">Aplicaciones Ind. <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
</section>

    <!-- Slide 9: Electrólisis NaCl Fundido -->
    <section id="nacl-molten" class="section">
        <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Electrólisis de NaCl Fundido (Celda Downs)</h2>
            <p class="text-xl text-blue-100 mb-8">Cuando el NaCl se funde (~801 °C), sus iones Na⁺ y Cl⁻ adquieren movilidad, permitiendo la conducción eléctrica y la electrólisis.</p>
            <div class="mb-8">
                 <!-- Could add a diagram image here later -->
                 <img src="20_6.gif" alt="Diagrama de celda Downs para NaCl fundido" class="w-full max-w-md mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
            </div>
            <div class="text-left max-w-2xl mx-auto">
                 <h3 class="text-2xl font-semibold mb-4 text-blue-300">Reacciones:</h3>
                 <p class="text-xl mb-4">Iones presentes: \( \text{Na}^+(l), \text{Cl}^-(l) \)</p>
                 <p class="text-xl mb-2">En el Cátodo (-): Reducción del Na⁺</p>
                 <p class="text-xl ml-8 mb-4">\( \text{Na}^+(l) + e^- \rightarrow \text{Na}(l) \quad E^\circ = -2.71 \text{ V} \)</p>
                 <p class="text-xl mb-2">En el Ánodo (+): Oxidación del Cl⁻</p>
                 <p class="text-xl ml-8 mb-4">\( 2\text{Cl}^-(l) \rightarrow \text{Cl}_2(g) + 2e^- \quad E^\circ = +1.36 \text{ V} \)</p>
                 <h3 class="text-2xl font-semibold mb-4 text-blue-300">Reacción Global:</h3>
                 <p class="text-xl ml-8 mb-4">\( 2\text{Na}^+(l) + 2\text{Cl}^-(l) \rightarrow 2\text{Na}(l) + \text{Cl}_2(g) \quad E^\circ_{celda} = -4.07 \text{ V} \)</p>
                 <p class="text-lg italic text-blue-200">Se requiere un voltaje aplicado mayor a 4.07 V (más sobrepotenciales y caída IR) para forzar esta reacción no espontánea.</p>
             </div>

            <div class="nav-button-container">
                 <a href="#exercises" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a>
                 <a href="#nacl-aqueous-competing" class="nav-button">Electrólisis Acuosa <i class="fas fa-arrow-right ml-2"></i></a>
            </div>
        </div>
    </section>

    <!-- Slide 10: Electrólisis NaCl Acuoso - Reacciones Competingtes -->
    <section id="nacl-aqueous-competing" class="section">
        <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Electrólisis de NaCl Acuoso: Reacciones Competitivas</h2>
            <p class="text-xl text-blue-100 mb-8">En solución acuosa, además de Na⁺ y Cl⁻, también está presente el agua (\( \text{H}_2\text{O} \)). Esto introduce reacciones competitivas en ambos electrodos.</p>

             <div class="flex flex-col md:flex-row gap-12 items-start max-w-7xl mx-auto">
                 <div class="w-full md:w-1/2">
                     <h3 class="text-2xl font-semibold mb-4 text-blue-300">Posibles Reacciones en el Cátodo (-):</h3>
                      <p class="text-lg mb-2">Los cationes y el agua pueden reducirse. Se reduce la especie con el potencial de reducción más ALTO (menos negativo).</p>
                     <p class="text-xl ml-4 mb-2">\( \text{Na}^+(ac) + e^- \rightarrow \text{Na}(s) \quad E^\circ = -2.71 \text{ V} \)</p>
                     <p class="text-xl ml-4 mb-4">\( 2\text{H}_2\text{O}(l) + 2e^- \rightarrow \text{H}_2(g) + 2\text{OH}^-(ac) \quad E^\circ = -0.83 \text{ V} \) (en medio neutro/básico)</p>
                      <p class="text-lg text-blue-200 italic">Comparando potenciales, el agua (\( -0.83 \text{ V} \)) se reduce mucho más fácilmente que el Na⁺ (\( -2.71 \text{ V} \)).</p>
                 </div>
                  <div class="w-full md:w-1/2">
                     <h3 class="text-2xl font-semibold mb-4 text-blue-300">Posibles Reacciones en el Ánodo (+):</h3>
                      <p class="text-lg mb-2">Los aniones y el agua pueden oxidarse. Se oxida la especie con el potencial de oxidación más ALTO (potencial de reducción más BAJO).</p>
                     <p class="text-xl ml-4 mb-2">\( 2\text{Cl}^-(ac) \rightarrow \text{Cl}_2(g) + 2e^- \quad E^\circ_{ox} = -1.36 \text{ V} \)</p>
                     <p class="text-xl ml-4 mb-4">\( 2\text{H}_2\text{O}(l) \rightarrow \text{O}_2(g) + 4\text{H}^+(ac) + 4e^- \quad E^\circ_{ox} = -1.23 \text{ V} \) (en medio ácido)</p>
                      <p class="text-lg text-blue-200 italic">Comparando potenciales estándar de oxidación, el agua (\( -1.23 \text{ V} \)) *parece* oxidarse más fácilmente que el Cl⁻ (\( -1.36 \text{ V} \)).</p>
                 </div>
             </div>
             <p class="text-2xl font-semibold text-yellow-400 mt-8 mb-4">Entonces, ¿qué reacciones ocurren realmente?</p>
             <p class="text-xl text-blue-100 mb-8">Las reacciones reales pueden verse afectadas por la <span class="highlight">concentración</span> (ecuación de Nernst) y los <span class="highlight">sobrepotenciales</span> (voltaje adicional necesario para que una reacción ocurra a una velocidad apreciable, especialmente formación de gases).</p>


            <div class="nav-button-container">
                 <a href="#nacl-molten" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a>
                 <a href="#nacl-aqueous-concentration" class="nav-button">Efecto Concentración <i class="fas fa-arrow-right ml-2"></i></a>
            </div>
        </div>
    </section>

    <!-- Slide 11: Electrólisis NaCl Acuoso - Efecto Concentración y Sobrepotencial -->
     <section id="nacl-aqueous-concentration" class="section">
        <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Electrólisis de NaCl Acuoso: Concentración y Sobrepotencial</h2>

            <div class="flex flex-col md:flex-row gap-12 items-start max-w-7xl mx-auto">
                 <div class="w-full md:w-1/2">
                     <h3 class="text-2xl font-semibold mb-4 text-blue-300">Reacciones Reales en Solución Concentrada (Proceso Cloro-Álcali):</h3>
                      <p class="text-lg mb-4">En soluciones concentradas de NaCl (salmuera), el <span class="highlight-orange">sobrepotencial</span> para la formación de \( \text{O}_2 \) es significativo (~0.4-0.6V en ánodos inertes). Aunque la oxidación de \( \text{H}_2\text{O} \) tiene un potencial estándar ligeramente menos negativo (\( -1.23 \text{ V} \)), la alta concentración de \( \text{Cl}^- \) (cuyo potencial de oxidación se vuelve menos negativo por la ecuación de Nernst, además de tener un menor sobrepotencial en muchos materiales) en el ánodo le permite competir exitosamente y ser oxidado preferentemente.</p>
                      <p class="text-xl ml-4 mb-2"><i class="fas fa-arrow-right text-blue-400"></i> En el Cátodo (-): Siempre se reduce el agua:</p>
                     <p class="text-xl ml-8 mb-4">\( 2\text{H}_2\text{O}(l) + 2e^- \rightarrow \text{H}_2(g) + 2\text{OH}^-(ac) \)</p>
                      <p class="text-xl ml-4 mb-2"><i class="fas fa-arrow-right text-blue-400"></i> En el Ánodo (+): Se oxida el cloruro (si el ánodo es inerte):</p>
                     <p class="text-xl ml-8 mb-4">\( 2\text{Cl}^-(ac) \rightarrow \text{Cl}_2(g) + 2e^- \)</p>
                     <h4 class="text-xl font-semibold mb-2 text-blue-300">Reacción Global (Concentrada, Ánodo Inerte):</h4>
                      <p class="text-xl ml-8">\( 2\text{NaCl}(ac) + 2\text{H}_2\text{O}(l) \rightarrow \text{H}_2(g) + \text{Cl}_2(g) + 2\text{NaOH}(ac) \)</p>
                      <p class="text-sm text-blue-200 italic mt-2">(Este es el proceso industrial Cloro-Álcali para producir H₂, Cl₂ y NaOH).</p>
                 </div>
                  <div class="w-full md:w-1/2">
                     <h3 class="text-2xl font-semibold mb-4 text-blue-300">Reacciones Reales en Solución Diluida:</h3>
                      <p class="text-lg mb-4">En soluciones diluidas de NaCl, la concentración de \( \text{Cl}^- \) es muy baja. Según la ecuación de Nernst, un potencial más negativo se requiere para oxidar el Cl⁻ a bajas concentraciones. En este caso, el efecto de la baja concentración de \( \text{Cl}^- \) se vuelve más importante que el sobrepotencial del \( \text{O}_2 \), haciendo que la oxidación del agua sea energéticamente más favorable.</p>
                       <p class="text-xl ml-4 mb-2"><i class="fas fa-arrow-right text-blue-400"></i> En el Cátodo (-): Siempre se reduce el agua:</p>
                     <p class="text-xl ml-8 mb-4">\( 2\text{H}_2\text{O}(l) + 2e^- \rightarrow \text{H}_2(g) + 2\text{OH}^-(ac) \)</p>
                      <p class="text-xl ml-4 mb-2"><i class="fas fa-arrow-right text-blue-400"></i> En el Ánodo (+): Se oxida el agua (si el ánodo es inerte):</p>
                     <p class="text-xl ml-8 mb-4">\( 2\text{H}_2\text{O}(l) \rightarrow \text{O}_2(g) + 4\text{H}^+(ac) + 4e^- \)</p>
                     <h4 class="text-xl font-semibold mb-2 text-blue-300">Reacción Global (Diluida, Ánodo Inerte):</h4>
                      <p class="text-xl ml-8">\( 2\text{H}_2\text{O}(l) \rightarrow 2\text{H}_2(g) + \text{O}_2(g) \)</p>
                      <p class="text-sm text-blue-200 italic mt-2">(La electrólisis del agua se vuelve la reacción principal).</p>
                 </div>
             </div>


            <div class="nav-button-container">
                 <a href="#nacl-aqueous-competing" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a>
                 <a href="#nacl-interactive" class="nav-button">Probar App Interactiva <i class="fas fa-arrow-right ml-2"></i></a>
            </div>
        </div>
    </section>

    <!-- Slide 12: NaCl Electrolysis Interactive App -->
    <section id="nacl-interactive" class="section">
         <div class="section-content">
             <h2 class="text-4xl font-bold mb-8 text-center">App Interactiva: Predicción de Reacciones en Electrólisis de NaCl</h2>
             <p class="text-xl text-blue-100 mb-8 text-center">Explora qué reacciones se predicen por potencial y cuáles ocurren realmente en distintas condiciones de NaCl.</p>

             <div class="flex flex-col md:flex-row items-start gap-8 max-w-9xl mx-auto">
                 <div class="w-full md:w-1/2">
                     <div class="interactive-controls">
                          <h4 class="text-xl font-semibold text-center mb-4 text-blue-300">Configura la Celda de NaCl</h4>
                          <!-- Electrolyte Type Select -->
                          <div class="control-group"> <label for="nacl-electrolyte-type">Estado del NaCl:</label> <select id="nacl-electrolyte-type" class="w-full"> <option value="molten" selected>Fundido (Molten)</option> <option value="aqueous_conc">Acuoso Concentrado</option> <option value="aqueous_dilute">Acuoso Diluido</option> </select> </div>
                          <!-- Anode Material Select -->
                          <div class="control-group"> <label for="nacl-anode-material">Material del Ánodo:</label> <select id="nacl-anode-material" class="w-full"> <option value="Inert" selected>Inerte (Grafito, Pt)</option> <option value="ActiveCu">Cobre (Cu)</option> </select> </div>
                           <!-- Cathode Material Select (less impact on products here, but include for completeness) -->
                          <div class="control-group"> <label for="nacl-cathode-material">Material del Cátodo (Superficie):</label> <select id="nacl-cathode-material" class="w-full"> <option value="Inert" selected>Inerte</option> <option value="ActiveCu">Cobre (Cu)</option> <option value="ActiveNa">Sodio (Na)</option> <!-- Added Na cathode --> </select> </div>
                     </div>
                 </div>
                 <div class="w-full md:w-1/2">
                      <h3 class="text-2xl font-semibold mb-4 text-blue-300">Resultados:</h3>
                      <div class="output-display text-left">
                          <p class="text-yellow-400 font-semibold mb-4"><i class="fas fa-flask"></i> Condiciones Seleccionadas: <span id="nacl-selected-conditions">...</span></p>

                          <h4 class="text-xl font-semibold mb-2 text-blue-300">Predicción (Basada Solo en E°):</h4>
                           <p id="nacl-predicted-cathode" class="text-lg ml-4 italic">Cátodo (-): ...</p>
                           <p id="nacl-predicted-anode" class="text-lg ml-4 italic mb-4">Ánodo (+): ...</p>

                           <h4 class="text-xl font-semibold mb-2 text-green-400">Reacciones Reales:</h4>
                            <p id="nacl-actual-cathode" class="text-lg ml-4"><i class="fas fa-check-circle text-green-400 mr-2"></i> Cátodo (-): ...</p>
                            <p id="nacl-actual-anode" class="text-lg ml-4 mb-4"><i class="fas fa-check-circle text-green-400 mr-2"></i> Ánodo (+): ...</p>

                            <h4 class="text-xl font-semibold mb-2 text-yellow-400">Explicación:</h4>
                             <p id="nacl-explanation" class="text-base ml-4 text-blue-200">...</p>
                      </div>
                 </div>
             </div>

            <div class="nav-button-container">
                 <a href="#nacl-aqueous-concentration" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Anterior</a>
                 <a href="#industrial-applications" class="nav-button">Aplicaciones Industriales <i class="fas fa-arrow-right ml-2"></i></a>
            </div>
         </div>
    </section>
    <!-- Slide 9: Industrial Applications Overview -->
   <section id="industrial-applications" class="section">
       <!-- Contenido sin cambios -->
        <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Aplicaciones Industriales Clave</h2>
            <p class="text-xl text-blue-100 mb-12 text-center">Producción a gran escala de materiales.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8">
                <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border flex flex-col"> <h3 class="text-2xl font-semibold mb-3 text-blue-300">Producción Zn</h3> <p class="text-sm flex-grow">Electroobtención Zn (>99.9%) de ZnSO₄. \( \text{Zn}^{2+} + 2e^- \rightarrow \text{Zn}(s) \)</p> <div class="text-center mt-auto"> <a href="#zinc-production-diagram">Ver Diagrama</a> </div> </div>
                <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border flex flex-col"> <h3 class="text-2xl font-semibold mb-3 text-blue-300">Proceso Cloro-Álcali</h3> <p class="text-sm flex-grow">Electrólisis salmuera → Cl₂, H₂, NaOH. \( 2\text{NaCl} + 2\text{H}_2\text{O} \rightarrow \text{Cl}_2 + \text{H}_2 + 2\text{NaOH} \).</p> <div class="text-center mt-auto"> <a href="#chlor-alkali-diagram">Ver Diagrama</a> </div> </div>
                <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border flex flex-col"> <h3 class="text-2xl font-semibold mb-3 text-blue-300">Refinación Cu</h3> <p class="text-sm flex-grow">Purificación Cu bruto (>99.99%). Ánodo impuro, Cátodo puro. \( \text{Cu}(\text{impuro}) \rightarrow \text{Cu}(\text{puro}) \).</p> <div class="text-center mt-auto"> <a href="#copper-refining-diagram">Ver Diagrama</a> </div> </div>
                <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border flex flex-col"> <h3 class="text-2xl font-semibold mb-3 text-blue-300">Producción F₂</h3> <p class="text-sm flex-grow">Único método. Electrólisis HF/KF fundido. \( 2\text{HF} \rightarrow \text{H}_2 + \text{F}_2 \).</p> <div class="text-center mt-auto"> <a href="#fluorine-production-diagram">Ver Diagrama</a> </div> </div>
            </div>
            <div class="nav-button-container"> <a href="#nacl-interactive" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Ejercicios</a> <a href="#zinc-production-diagram" class="nav-button">Diagramas Ind. <i class="fas fa-arrow-right ml-2"></i></a> </div>
        </div>
   </section>

    <!-- Slide 10: Zinc Production Diagram (CSS Based) -->
    <section id="zinc-production-diagram" class="section">
        <!-- Diagrama de Producción de Zinc ahora con una imagen JPG -->
        <div class="section-content">
             <h2 class="text-4xl font-bold mb-8 text-center">Diagrama: Producción de Zinc (Electroobtención)</h2>
             <!-- Subtítulo actualizado -->
             <p class="text-center text-blue-200 mb-8">Diagrama del Proceso</p>
             <!-- Aquí va la imagen JPG -->
             <img src="Zinc1.gif" alt="Diagrama del proceso industrial de electroobtención de zinc" class="w-full max-w-4xl mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
             <!-- Los botones de navegación se mantienen -->
             <div class="nav-button-container"> <a href="#industrial-applications" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Aplicaciones</a> <a href="#chlor-alkali-diagram" class="nav-button">Siguiente Diag. <i class="fas fa-arrow-right ml-2"></i></a> </div>
        </div>
    </section>

    <!-- Slide 11: Chlor-Alkali Diagram (CSS Based) -->
     <!-- Slide 11: Chlor-Alkali Diagram (Ahora con imagen JPG) -->
    <section id="chlor-alkali-diagram" class="section">
         <div class="section-content">
             <h2 class="text-4xl font-bold mb-8 text-center">Diagrama: Proceso Cloro-Álcali (Membrana)</h2>
             <!-- Subtítulo actualizado -->
             <p class="text-center text-blue-200 mb-8">Diagrama del Proceso</p>
             <!-- Aquí va la imagen JPG -->
             <!-- Puedes ajustar el max-w-xl a max-w-lg, max-w-2xl, etc. según prefieras -->
             <img src="celula_con_membrana_0.jpg" alt="Diagrama del proceso industrial Cloro-Álcali (Celda de Membrana)" class="w-full max-w-4xl mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
              <!-- Los botones de navegación se mantienen -->
              <div class="nav-button-container"> <a href="#zinc-production-diagram" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Diag. Anterior</a> <a href="#copper-refining-diagram" class="nav-button">Siguiente Diag. <i class="fas fa-arrow-right ml-2"></i></a> </div>
         </div>
    </section>

    <!-- Slide 12: Copper Refining Diagram (CSS Based) -->
    <!-- Slide 12: Copper Refining Diagram (Ahora con imagen JPG) -->
    <section id="copper-refining-diagram" class="section">
        <div class="section-content">
             <h2 class="text-4xl font-bold mb-8 text-center">Diagrama: Refinación Electrolítica de Cobre</h2>
             <!-- Subtítulo actualizado -->
             <p class="text-center text-blue-200 mb-8">Diagrama del Proceso</p>
             <!-- Aquí va la imagen JPG -->
             <!-- Puedes ajustar el max-w-xl a otro valor si lo deseas -->
             <img src="ZAP_IndustrialApplications.es_ES.x512.png" alt="Diagrama del proceso industrial de refinación electrolítica de cobre" class="w-full max-w-xl mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
             <!-- Los botones de navegación se mantienen -->
             <div class="nav-button-container"> <a href="#chlor-alkali-diagram" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Diag. Anterior</a> <a href="#fluorine-production-diagram" class="nav-button">Siguiente Diag. <i class="fas fa-arrow-right ml-2"></i></a> </div>
        </div>
    </section>

    <!-- Slide 13: Fluorine Production Diagram (CSS Based) -->
    <!-- Slide 13: Fluorine Production Diagram (Ahora con imagen JPG) -->
    <section id="fluorine-production-diagram" class="section">
         <div class="section-content">
             <h2 class="text-4xl font-bold mb-8 text-center">Diagrama: Producción de Flúor</h2>
              <!-- Subtítulo actualizado -->
              <p class="text-center text-blue-200 mb-8">Diagrama del Proceso</p>
             <!-- Aquí va la imagen JPG -->
             <!-- Puedes ajustar el max-w-xl a otro valor si lo deseas -->
             <img src="3-s2.0-B9781455774425000024-f02-02-9781455774425.jpg" alt="Diagrama del proceso industrial de producción de flúor" class="w-full max-w-xl mx-auto mb-4 border border-blue-400 rounded-lg shadow-lg">
             <!-- Los botones de navegación se mantienen -->
             <div class="nav-button-container"> <a href="#copper-refining-diagram" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Diag. Anterior</a> <a href="#technical-aspects" class="nav-button">Aspectos Técnicos <i class="fas fa-arrow-right ml-2"></i></a> </div>
         </div>
    </section>

    <!-- Slide 14: Technical Aspects -->
   <section id="technical-aspects" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Aspectos Técnicos Clave</h2>
            <p class="text-xl text-blue-100 mb-12 text-center">Diseño y operación industrial.</p>
            <div class="comparison-grid">
                 <div class="comparison-item"> <h3><i class="fas fa-cogs"></i>Electrodos</h3> <ul class="text-sm"><li>Selección crítica</li><li>Inertes (DSA®, Pt)</li><li>Activos (Cu impuro)</li><li>Propiedades: Conductividad, resistencia, costo</li></ul> </div>
                 <div class="comparison-item"> <h3><i class="fas fa-filter"></i>Separadores</h3> <ul class="text-sm"><li>Función: Separar productos</li><li>Diafragmas: Porosos</li><li>Membranas: Selectivas (Nafion®)</li><li>Clave en Cloro-Álcali, PEM</li></ul> </div>
                 <div class="comparison-item"> <h3><i class="fas fa-charging-station"></i>Eficiencia</h3> <ul class="text-sm"><li>Electrointensivo</li><li>\( V_{apl} > |-E_{celda}| + \eta + IR \)</li><li>Sobrepotenciales ($\eta$)</li><li>Caída Óhmica (IR)</li><li>Consumo Específico (kWh/kg)</li></ul> </div>
                 <div class="comparison-item"> <h3><i class="fas fa-thermometer-half"></i>Otros</h3> <ul class="text-sm"><li>Temperatura</li><li>Densidad Corriente</li><li>Concentración/pH</li><li>Agitación/Flujo</li></ul> </div>
            </div>
            <div class="nav-button-container"> <a href="#fluorine-production-diagram" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Diag. Anterior</a> <a href="#other-applications" class="nav-button">Otras Aplic. <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
   </section>

    <!-- Slide 15: Other Applications -->
   <section id="other-applications" class="section">
       <!-- Contenido sin cambios -->
       <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Otras Aplicaciones</h2>
            <p class="text-xl text-blue-100 mb-12 text-center">Más allá de la producción básica.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                 <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border items-center text-center"> <div class="icon mb-4"><i class="fas fa-fill-drip text-3xl text-yellow-400"></i></div> <h3 class="text-2xl font-semibold mb-3">Galvanoplastia</h3> <p class="text-sm">Recubrimiento metálico (Cr, Ni, Ag).</p> </div>
                 <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border items-center text-center"> <div class="icon mb-4"><i class="fas fa-paint-roller text-3xl text-gray-400"></i></div> <h3 class="text-2xl font-semibold mb-3">Anodizado</h3> <p class="text-sm">Capa óxido protectora (Al₂O₃).</p> </div>
                 <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border items-center text-center"> <div class="icon mb-4"><i class="fas fa-microscope text-3xl text-purple-400"></i></div> <h3 class="text-2xl font-semibold mb-3">Electrosíntesis</h3> <p class="text-sm">Síntesis química "limpia".</p> </div>
                 <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border items-center text-center"> <div class="icon mb-4"><i class="fas fa-water text-3xl text-blue-400"></i></div> <h3 class="text-2xl font-semibold mb-3">Trat. Aguas</h3> <p class="text-sm">Electrocoagulación, desinfección.</p> </div>
                 <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border items-center text-center"> <div class="icon mb-4"><i class="fas fa-battery-full text-3xl text-green-400"></i></div> <h3 class="text-2xl font-semibold mb-3">Carga Baterías</h3> <p class="text-sm">Electrólisis forzada reversible.</p> </div>
                 <div class="bg-blue-900 bg-opacity-40 p-6 rounded-lg border items-center text-center"> <div class="icon mb-4"><i class="fas fa-wind text-3xl text-cyan-400"></i></div> <h3 class="text-2xl font-semibold mb-3">H₂ Verde</h3> <p class="text-sm">Electrólisis agua con renovables.</p> </div>
            </div>
            <div class="nav-button-container"> <a href="#technical-aspects" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Aspectos Técnicos</a> <a href="#summary" class="nav-button">Resumen <i class="fas fa-arrow-right ml-2"></i></a> </div>
       </div>
   </section>

    <!-- Slide 16: Summary -->
   <section id="summary" class="section">
       <!-- Contenido sin cambios -->
        <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Resumen y Puntos Clave</h2>
            <div class="comparison-grid">
                 <div class="comparison-item"> <h3><i class="fas fa-balance-scale"></i>Galvánica vs Electrolítica</h3> <ul><li>Galv: Espontánea, genera e⁻, An(-)</li><li>Elect: No espontánea, requiere e⁻, An(+)</li></ul> </div>
                 <div class="comparison-item"> <h3><i class="fas fa-exchange-alt"></i>Definiciones</h3> <ul><li>Oxidación → Ánodo</li><li>Reducción → Cátodo</li><li>Signos dependen del tipo</li></ul> </div>
                 <div class="comparison-item"> <h3><i class="fas fa-calculator"></i>Leyes Faraday</h3> <ul><li>Carga (Q) ↔ Masa (m)</li><li>\( m = (MIt)/(zF) \)</li><li>Cálculos precisos</li></ul> </div>
                 <div class="comparison-item"> <h3><i class="fas fa-industry"></i>Aplicaciones</h3> <ul><li>Producción (Al, Cl₂, H₂)</li><li>Refino (Cu)</li><li>Superficies</li><li>Energía (Bat, H₂)</li></ul> </div>
            </div>
            <div class="nav-button-container"> <a href="#other-applications" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Otras Aplic.</a> <a href="#final-summary" class="nav-button">Para recordar <i class="fas fa-check-circle ml-2"></i></a> </div>
       </div>
   </section>
    <!-- Slide 16 (New): Final Summary of Key Concepts -->
    <section id="final-summary" class="section">
        <div class="section-content">
            <h2 class="text-4xl font-bold mb-8 text-center">Resumen Final: Lo que Debes Recordar</h2>
            <p class="text-xl text-blue-100 mb-12 text-center">Conceptos esenciales de la electrólisis.</p>

            <div class="comparison-grid">
                 <!-- Block 1: Core Definition -->
                 <div class="comparison-item">
                     <h3><i class="fas fa-flask"></i> ¿Qué es la Electrólisis?</h3>
                     <ul>
                         <li>Proceso para forzar rxn <span class="highlight-orange">no espontánea</span>.</li>
                         <li>Convierte Energía <span class="highlight-orange">Eléctrica</span> \(\to\) <span class="highlight-green">Química</span>.</li>
                         <li>Requiere fuente DC externa.</li>
                     </ul>
                 </div>
                 <!-- Block 2: Cells Comparison & Electrode Roles -->
                 <div class="comparison-item">
                     <h3><i class="fas fa-exchange-alt"></i> Electrolítica vs Galvánica</h3>
                     <ul>
                         <li>Electrolítica: No espontánea, Ánodo(+), Cátodo(-).</li>
                         <li>Galvánica: Espontánea, Ánodo(-), Cátodo(+).</li>
                         <li><span class="highlight">Oxidación SIEMPRE en Ánodo</span>.</li>
                         <li><span class="highlight">Reducción SIEMPRE en Cátodo</span>.</li>
                     </ul>
                 </div>
                 <!-- Block 3: Faraday's Laws -->
                 <div class="comparison-item">
                     <h3><i class="fas fa-calculator"></i> Leyes de Faraday</h3>
                     <ul>
                         <li>Cant. sustancia \(\propto\) Cant. Carga (\(Q=I \cdot t\)).</li>
                         <li>Cant. sustancia \(\propto\) Peso Equivalente (\(M/z\)).</li>
                         <li>Fórmula: \( m = \frac{M \cdot I \cdot t}{z \cdot F} \).</li>
                         <li>Constante F: \(96485 \, C/mol \, e^-\).</li>
                     </ul>
                 </div>
                 <!-- Block 4: Predicting Products & Key Factors -->
                 <div class="comparison-item">
                     <h3><i class="fas fa-balance-scale"></i> Reacciones Reales (Acuosa)</h3>
                     <ul>
                         <li>Agua (\(\text{H}_2\text{O}\)) compite en Ánodo y Cátodo.</li>
                         <li><span class="highlight-orange">Sobrepotencial</span> (ej: O₂ gas) y <span class="highlight">Concentración</span> son cruciales.</li>
                         <li>No siempre gana la reacción con mejor \(E^\circ\) estándar.</li>
                     </ul>
                 </div>
                  <!-- Block 5: Applications -->
                 <div class="comparison-item">
                     <h3><i class="fas fa-industry"></i> Aplicaciones Clave</h3>
                     <ul>
                         <li>Producción (Cl₂, H₂, NaOH, Al, F₂, Na, Zn).</li>
                         <li>Refinación (Cu).</li>
                         <li>Recubrimientos (Galvanoplastia).</li>
                         <li>H₂ Verde / Energía (Baterías recargables).</li>
                     </ul>
                 </div>
                  <!-- Block 6: Key Terms -->
                 <div class="comparison-item">
                     <h3><i class="fas fa-book"></i> Glosario Esencial</h3>
                     <ul>
                         <li>Celda Electrolítica, Ánodo, Cátodo.</li>
                         <li>Electrolito, Reacción Redox.</li>
                         <li>Leyes de Faraday, Constante F, Peso Equivalente.</li>
                         <li>Sobrepotencial.</li>
                         <li>Cloro-Álcali, Electroobtención, Refinación.</li>
                     </ul>
                 </div>
            </div>

             <!-- Navigation Buttons -->
            <div class="nav-button-container">
                <a href="#summary" class="nav-button"><i class="fas fa-arrow-left mr-2"></i> Otras Aplic.</a>
                <a href="#thank-you" class="nav-button">Finalizar <i class="fas fa-check-circle ml-2"></i></a>
            </div>
        </div>
    </section>
    <!-- Slide 17: Thank You -->
   <section id="thank-you" class="section" style="border-bottom: none;">
       <!-- Contenido sin cambios -->
        <div class="section-content text-center">
            <h2 class="text-5xl font-bold mb-8 text-blue-300">¡Gracias!</h2>
            <p class="text-2xl text-blue-100 mb-12">Espero haya sido útil para comprender la electrólisis.</p>
             <p class="text-3xl font-semibold text-yellow-400 animate-pulse">¿Preguntas?</p>
              <div class="mt-16"> <i class="fas fa-flask fa-3x text-blue-400 mx-4"></i> <i class="fas fa-bolt fa-3x text-yellow-400 mx-4"></i> <i class="fas fa-industry fa-3x text-gray-400 mx-4"></i> </div>
             <div class="nav-button-container"> <a href="#title" class="nav-button"><i class="fas fa-home mr-2"></i> Inicio</a> </div>
         </div>
   </section>

<script>
    // --- Basic Setup ---
    // Sets the current date on the element with id 'current-date'
    document.getElementById('current-date').textContent = new Date().toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });

    // Adds event listeners to toggle visibility of calculation steps
    document.querySelectorAll('.toggle-calculation').forEach(button => {
        button.addEventListener('click', function() {
            // Gets the next sibling element, which is expected to be the calculation steps div
            const calculationSteps = this.nextElementSibling;
            // Finds the icon element within the button
            const icon = this.querySelector('i');
            // Checks if the calculation steps are currently hidden or their display is not set
            if (calculationSteps && (calculationSteps.style.display === 'none' || calculationSteps.style.display === '')) {
                // If hidden, shows the calculation steps
                calculationSteps.style.display = 'block';
                // Updates the button text and icon to indicate it will now hide the steps
                this.innerHTML = '<i class="fas fa-eye-slash mr-2"></i>Ocultar Cálculo';
            } else if (calculationSteps) { // Checks if the element exists and is visible
                // If visible, hides the calculation steps
                calculationSteps.style.display = 'none';
                // Updates the button text and icon to indicate it will now show the steps
                this.innerHTML = '<i class="fas fa-eye mr-2"></i>Mostrar Cálculo';
            }
        });
    });

    // --- Constants and Data for Electrochemistry ---
    // Defines molar masses (M) and number of electrons (z) per mole of substance/reaction,
    // along with product type (mass or volume) and unit for various substances.
    const substances = {
        Cu2: { M: 63.546, z: 2, type: 'mass', unit: 'g', name: 'Cu(s)' },
        Ag1: { M: 107.868, z: 1, type: 'mass', unit: 'g', name: 'Ag(s)' },
        Al3: { M: 26.982, z: 3, type: 'mass', unit: 'g', name: 'Al(s)' }, // Not typically deposited from aq, but data is here
        Au3: { M: 196.967, z: 3, type: 'mass', unit: 'g', name: 'Au(s)' }, // For anode mud example
        H2:  { M: 2.016, z: 2, type: 'volume', unit: 'L', name: 'H₂(g)' },
        Cl2: { M: 70.906, z: 2, type: 'volume', unit: 'L', name: 'Cl₂(g)' },
        O2:  { M: 31.999, z: 4, type: 'volume', unit: 'L', name: 'O₂(g)' },
        Na1: { M: 22.990, z: 1, type: 'mass', unit: 'g', name: 'Na(s)' } // Added Na (as solid for comparison)
    };
    const F = 96485; // Faraday Constant (C/mol e-) - Approximate value often used
    // Using Standard Ambient Temperature and Pressure (SATP: 25°C, 1 bar) for molar volume for "TPE"
    const MOLAR_VOLUME_SATP = 24.79; // L/mol at SATP

    // Define minimum voltage required for Faraday 1 demo (Cu refining) for visualization trigger
    const V_REQUIRED_F1 = 1.5; // Approximate minimum voltage for Cu refining

    // Define standard potentials (E° vs SHE). Used primarily for Prediction in NaCl interactive.
    const standardPotentials = {
        // Reduction Potentials (Cathode)
        'Ag+': +0.80,
        'Cu2+': +0.34,
        'H+': 0.00, // Standard potential for H+ reduction (acidic conditions)
        'H2O_red_neutral': -0.83, // Approximate potential for H2O reduction in neutral/basic solution (pH 7, pOH 7)
        'Na+': -2.71,

        // Oxidation Potentials (Anode) - Note: E°ox = -E°red
        'Cl-': -1.36, // From E°red = +1.36 (Cl2 formation)
        'H2O_ox': -1.23, // From E°red = +1.23 (O2 formation in acid, potential depends on pH)
        'Cu_ox': -0.34, // From E°red = +0.34 (Cu oxidation)
        'Al_ox': +1.66 // From E°red = -1.66 (Al oxidation)
    };

    // Data structure for *typically observed* reactions and products used in F2 and F3 quantitative calculations,
    // and for the 'Actual Reactions' in the NaCl interactive.
    // This incorporates simplified understanding of competing reactions, esp. for NaCl aqueous.
    const reactionDataCalculations = {
        // Cathode reactions (Reduction) - Determined by solution type
        CuSO4: { reaction: `Cátodo (-): \\( \\text{Cu}^{2+} + 2e^- \\rightarrow \\text{Cu}(s) \\)`, product: substances['Cu2'] }, // Cu2+ reduced
        AgNO3: { reaction: `Cátodo (-): \\( \\text{Ag}^{+} + e^- \\rightarrow \\text{Ag}(s) \\)`, product: substances['Ag1'] }, // Ag+ reduced
        // In aqueous NaCl (conc or dilute) or H2SO4, Water/H+ is reduced to H2
        NaCl_conc: { reaction: `Cátodo (-): \\( 2\\text{H}_2\\text{O}(l) + 2e^- \\rightarrow \\text{H}_2(g) + 2\\text{OH}^-(ac) \\)`, product: substances['H2'] }, // Water reduced to H2
        NaCl_dilute: { reaction: `Cátodo (-): \\( 2\\text{H}_2\\text{O}(l) + 2e^- \\rightarrow \\text{H}_2(g) + 2\\text{OH}^-(ac) \\)`, product: substances['H2'] }, // Water reduced to H2
        H2SO4: { reaction: `Cátodo (-): \\( 2\\text{H}^+(ac) + 2e^- \\rightarrow \\text{H}_2(g) \\)`, product: substances['H2'] }, // H+ reduced to H2
        // Molten NaCl cathode reaction (used only in NaCl interactive for 'actual')
        NaCl_molten_cathode: { reaction: `Cátodo (-): \\( \\text{Na}^+(l) + e^- \\rightarrow \\text{Na}(l) \\)`, product: substances['Na1'] }
    };

    // Anode reactions (Oxidation) - Determined by anode material AND solution type
    const anodeReactionDataCalculations = {
        // If Anode is Copper (Cu) - Cu oxidizes in most solutions containing its ions or other reducible species
        Cu: { // Cu -> Cu2+ + 2e-
             CuSO4: { reaction: `Ánodo (+): \\( \\text{Cu}(s) \\rightarrow \\text{Cu}^{2+}(ac) + 2e^- \\)`, product: {...substances['Cu2'], unit: 'g (Disuelto)'} }, // Cu oxidizes
             AgNO3: { reaction: `Ánodo (+): \\( \\text{Cu}(s) \\rightarrow \\text{Cu}^{2+}(ac) + 2e^- \\)`, product: {...substances['Cu2'], unit: 'g (Disuelto)'} },
             NaCl_conc: { reaction: `Ánodo (+): \\( \\text{Cu}(s) \\rightarrow \\text{Cu}^{2+}(ac) + 2e^- \\)`, product: {...substances['Cu2'], unit: 'g (Disuelto)'} },
             NaCl_dilute: { reaction: `Ánodo (+): \\( \\text{Cu}(s) \\rightarrow \\text{Cu}^{2+}(ac) + 2e^- \\)`, product: {...substances['Cu2'], unit: 'g (Disuelto)'} },
             H2SO4: { reaction: `Ánodo (+): \\( \\text{Cu}(s) \\rightarrow \\text{Cu}^{2+}(ac) + 2e^- \\)`, product: {...substances['Cu2'], unit: 'g (Disuelto)'} }
        },
        // If Anode is Inert (e.g., Graphite, Pt) - Anion or Water oxidation competes
        Inert: {
             // For NaCl aqueous, the actual product depends on concentration (incorporating overpotential/Nernst implicitly here for the "actual" outcome)
             // *** IMPORTANT: These are the 'actual' reactions for quantitative calcs in F2/F3 ***
             NaCl_conc: { reaction: `Ánodo (+): \\( 2\\text{Cl}^-(ac) \\rightarrow \\text{Cl}_2(g) + 2e^- \\)`, product: substances['Cl2'] }, // Cl- oxidation (concentrated NaCl, actual)
             NaCl_dilute: { reaction: `Ánodo (+): \\( 2\\text{H}_2\\text{O}(l) \\rightarrow \\text{O}_2(g) + 4\\text{H}^+(ac) + 4e^- \\)`, product: substances['O2'] }, // Water oxidation (diluted NaCl, actual)
             // For other solutions with inert anode, water is typically oxidized as anions (SO4, NO3) are harder to oxidize
             CuSO4: { reaction: `Ánodo (+): \\( 2\\text{H}_2\\text{O}(l) \\rightarrow \\text{O}_2(g) + 4\\text{H}^+(ac) + 4e^- \\)`, product: substances['O2'] },
             AgNO3: { reaction: `Ánodo (+): \\( 2\\text{H}_2\\text{O}(l) \\rightarrow \\text{O}_2(g) + 4\\text{H}^+(ac) + 4e^- \\)`, product: substances['O2'] },
             H2SO4: { reaction: `Ánodo (+): \\( 2\\text{H}_2\\text{O}(l) \\rightarrow \\text{O}_2(g) + 4\\text{H}^+(ac) + 4e^- \\)`, product: substances['O2'] }
        },
        // Molten NaCl anode reaction with Inert anode (used only in NaCl interactive for 'actual')
        NaCl_molten_anode_inert: { reaction: `Ánodo (+): \\( 2\\text{Cl}^-(l) \\rightarrow \\text{Cl}_2(g) + 2e^- \\)`, product: substances['Cl2'] }
    };


    // --- Helper Function for updating a single visual bar (mass or volume) ---
    // Updates the height and class of a visual bar element within an electrode
    function updateSpecificVisual(elementId, value, maxValue, productVisualType) {
         const element = document.getElementById(elementId);
         // Exit if the element does not exist
         if (!element) {
             // console.warn(`Visual element not found: ${elementId}`);
             return;
         }

        // Electrode height from CSS is 150px for .faraday-electrode
        const diagramHeight = 150;

        let height = 0;
        // Calculate height based on value relative to a scaled max value (110% of maxValue to prevent filling completely)
        // Only calculate if maxValue is positive to avoid division by zero
        if (maxValue > 0 && value > 0) {
             height = Math.min((value / (maxValue * 1.1)) * diagramHeight, diagramHeight);
        }
         // Ensure height is not negative
         height = Math.max(0, height);

         // Remove all potential visual type classes before adding the correct one
         element.classList.remove('dissolved-mass', 'deposited-mass', 'produced-gas');

        // Apply height and class based on product type for visual representation
         if (productVisualType === 'mass-dissolved') {
             element.classList.add('dissolved-mass'); // Applies specific color/style for dissolved mass
             element.style.height = height + 'px';
             element.style.bottom = 'auto'; // Grows from the top
             element.style.top = '0';
         } else if (productVisualType === 'mass-deposited') {
             element.classList.add('deposited-mass'); // Applies specific color/style for deposited mass
             element.style.height = height + 'px';
             element.style.top = 'auto';    // Grows from the bottom
             element.style.bottom = '0';
         } else if (productVisualType === 'volume-gas') {
             element.classList.add('produced-gas'); // Applies specific color/style for gas volume
             element.style.height = height + 'px';
             element.style.bottom = 'auto'; // Visual representation grows from the top
             element.style.top = '0';
         } else {
            // If no valid type or value is 0, clear the visual bar
             element.style.height = '0px';
             element.style.top = 'auto';    // Reset position
             element.style.bottom = 'auto'; // Reset position
         }
    }

    // Function to reset all specific visual bars and bubbles in a given section
    function resetSectionVisuals(sectionId) {
        const section = document.getElementById(sectionId);
        // Exit if the section element does not exist
        if (!section) return;

        // Select all elements within the section that are used for visual bars
        const allVisualBars = section.querySelectorAll('.deposited-mass, .dissolved-mass, .produced-gas');
        // Reset the height and remove type-specific classes for each visual bar
        allVisualBars.forEach(bar => {
             bar.style.height = '0px';
             bar.classList.remove('dissolved-mass', 'deposited-mass', 'produced-gas');
             // Also reset position in case it was manipulated
             bar.style.top = 'auto';
             bar.style.bottom = 'auto';
        });

         // Select all bubble elements within the section
         const allBubbles = section.querySelectorAll('.bubbles');
         // Remove the 'is-gassing' class from all bubble elements
         allBubbles.forEach(bubble => {
             bubble.classList.remove('is-gassing');
         });
    }

    // Helper to update bubble state (turn animation on/off)
    function updateBubbleVisual(bubbleElementId, isGassing) {
        const bubbleElement = document.getElementById(bubbleElementId);
        // Check if the bubble element exists
        if (bubbleElement) {
            if (isGassing) {
                // Add class to make bubbles visible and start animation
                bubbleElement.classList.add('is-gassing');
            } else {
                // Remove class to hide bubbles and pause animation
                bubbleElement.classList.remove('is-gassing');
            }
        }
    }

    // Helper to re-render KaTeX math formulas in specific elements
    function reRenderKatex(elementIds) {
        // Use a small timeout to ensure the DOM is updated before rendering math
        setTimeout(() => {
             // Check if KaTeX auto-render function is available
             if (typeof renderMathInElement === 'function') {
                 // Iterate through the list of element IDs
                 elementIds.forEach(id => {
                     const el = document.getElementById(id);
                     // Check if the element exists
                     if (el) {
                         // Remove any previously rendered KaTeX elements inside this element
                         // This prevents math formulas from being duplicated
                         Array.from(el.querySelectorAll('.katex')).forEach(child => child.remove());
                         // Render math formulas in the current element
                         renderMathInElement(el, {
                             delimiters: [ // Define delimiters for inline math
                                 {left: "\\(", right: "\\)", display: false}
                             ],
                             throwOnError: false // Don't throw errors if a formula fails to render
                         });
                     }
                 });
             }
        }, 50); // 50ms delay
    }


    // --- Faraday 1 Interactive Calculation (m = Q * Eq) ---
    // Calculates mass deposited/dissolved based on current, time, and applied voltage.
    // Simulates Cu refining where Cu dissolves at anode and deposits at cathode if voltage is sufficient.
    function calculateFaraday1() {
        // Get references to all relevant HTML elements
        const currentInput = document.getElementById('current-1');
        const timeInput = document.getElementById('time-1');
        const voltageInput = document.getElementById('voltage-1');
        const massSpan = document.getElementById('mass-1'); // Cathode mass output
        const anodeMassSpan = document.getElementById('anode-mass-1'); // Anode mass output
        const currentValueSpan = document.getElementById('current-value-1'); // Current value display
        const timeValueSpan = document.getElementById('time-value-1');       // Time value display
        const voltageValueSpan = document.getElementById('voltage-value-1'); // Voltage value display
        const chargeSpan = document.getElementById('charge-1');             // Charge output

        // Exit the function if any crucial element is missing
        if (!currentInput || !timeInput || !voltageInput || !massSpan || !anodeMassSpan || !currentValueSpan || !timeValueSpan || !voltageValueSpan || !chargeSpan) {
             console.warn("Faraday 1 elements not fully found, skipping calculation.");
             return;
         }

        // Get current values from the input elements and parse them as numbers
        const current = parseFloat(currentInput.value);
        const timeMinutes = parseFloat(timeInput.value);
        const timeSeconds = timeMinutes * 60; // Convert time to seconds
        const appliedVoltage = parseFloat(voltageInput.value);

        // Update the span elements to display the current slider values
        currentValueSpan.textContent = current.toFixed(1);
        timeValueSpan.textContent = timeMinutes.toFixed(1);
        voltageValueSpan.textContent = appliedVoltage.toFixed(1);

        // Calculate total charge passed (Q = I * t)
        const charge = current * timeSeconds;
        // Update the charge display span
        chargeSpan.textContent = charge.toFixed(0); // Display charge as an integer

        let mass = 0; // Initialize mass deposited at cathode to zero
        let anodeMassLost = 0; // Initialize mass dissolved at anode to zero

        // Define the substance data for Copper (Cu2+)
        const elementData = substances['Cu2']; // Uses the Cu2+ definition (z=2)

        // Check if the applied voltage is sufficient to drive the reaction
        // and if there is current flowing for a non-zero time.
        if (appliedVoltage >= V_REQUIRED_F1 && current > 0 && timeSeconds > 0) {
            // Calculate moles of electrons passed (n_e = Q / F)
            const moles_e = charge / F;

            // For Cu refining (Cu anode, Cu cathode, CuSO4 soln),
            // Cu is deposited at the cathode and dissolved at the anode.
            // Assuming 100% current efficiency for this main reaction.
            // Calculate moles of product (moles_product = n_e / z)
            const moles_product = moles_e / elementData.z;
            // Calculate mass of product (mass = moles_product * Molar_Mass)
            mass = moles_product * elementData.M; // Mass deposited at cathode
            anodeMassLost = mass; // Mass dissolved at anode is equal to mass deposited for Cu refining

        } else {
            // If voltage is too low or no current/time, no reaction products are formed.
            mass = 0;
            anodeMassLost = 0;
        }

        // Update the mass display spans, showing 3 decimal places
        massSpan.textContent = mass.toFixed(3);
        anodeMassSpan.textContent = anodeMassLost.toFixed(3);

        // --- Update Visuals ---
        // Calculate maximum expected mass for scaling the visual bars in Faraday 1 diagram.
        // Use the maximum slider values for Current (5.0 A) and Time (60.0 min) for Cu
        const maxCurrentF1 = parseFloat(currentInput.max);
        const maxTimeMinutesF1 = parseFloat(timeInput.max);
        const maxTimeSecondsF1 = maxTimeMinutesF1 * 60;
        const maxChargeF1 = maxCurrentF1 * maxTimeSecondsF1;
        // Calculate the maximum possible mass transformation for Cu with max charge
        const maxMassExpectedF1 = (elementData.M * maxChargeF1) / (elementData.z * F);

        // Reset previous visual bars and bubbles in the section
        resetSectionVisuals('faraday-1-interactive');

        // Update cathode visual (depositing mass) using 'deposited-mass-1'
        // Scale the visual height based on the calculated mass relative to the maximum expected mass.
        updateSpecificVisual('deposited-mass-1', mass, maxMassExpectedF1, 'mass-deposited');

        // Update anode visual (dissolving mass) using 'dissolved-mass-1'
        // Scale the visual height based on the calculated anode mass lost.
        updateSpecificVisual('dissolved-mass-1', anodeMassLost, maxMassExpectedF1, 'mass-dissolved');

        // Faraday 1 example (Cu refining) does not typically produce gas.
        // Ensure gas visual and bubble animations are off by default for this interactive.
        // The gas visual element 'produced-gas-1' exists in HTML but isn't used in updateSpecificVisual call here.
         updateBubbleVisual('anode-bubbles-1', false);
         updateBubbleVisual('cathode-bubbles-1', false);

        // KaTeX rendering for the static reaction labels in the F1 diagram area is handled by the initial auto-render on page load.
    }

    // --- Faraday 2 Interactive Calculation (m proportional to Eq for fixed Q) ---
    // Demonstrates the second law by showing varying product amounts (mass or volume)
    // for a fixed charge (1 Faraday) depending on the selected electrolyte and anode material.
    function calculateFaraday2() {
        // Get references to all relevant HTML elements
        const solutionSelect = document.getElementById('solution-select-2');
        const anodeSelect = document.getElementById('anode-select-2');
        const cathodeSelect = document.getElementById('cathode-select-2'); // Read for state display but not calculation logic
        const cathodeResultSpan = document.getElementById('cathode-result-2'); // Cathode product output
        const anodeResultSpan = document.getElementById('anode-result-2');     // Anode product output
        const anodeReactionP = document.getElementById('anode-reaction-2');     // Anode reaction display
        const cathodeReactionP = document.getElementById('cathode-reaction-2'); // Cathode reaction display

         // Exit the function if any crucial element is missing
         if (!solutionSelect || !anodeSelect || !cathodeSelect || !cathodeResultSpan || !anodeResultSpan || !anodeReactionP || !cathodeReactionP) {
              console.warn("Faraday 2 elements not fully found, skipping calculation.");
             return;
         }

        // Get selected values from the dropdowns
        const selectedSolutionKey = solutionSelect.value; // e.g., 'CuSO4', 'NaCl_conc', 'NaCl_dilute', 'H2SO4'
        const selectedAnodeMaterial = anodeSelect.value; // e.g., 'Cu', 'Inert'
        const selectedCathodeMaterial = cathodeSelect.value; // Read but not used in the main logic

        // --- Fixed Parameters for Faraday 2 Demo ---
        const charge = F; // Fixed charge of 1 Faraday
        const moles_e = charge / F; // Moles of electrons passed = 1 mol e-

        // --- Determine Reactions and Products based on selections ---
        // Cathode reaction is determined solely by the solution type in this simplified model
        // Use the key from the solution select to find the corresponding reaction data
        const cathodeReactionData = reactionDataCalculations[selectedSolutionKey];

        // Anode reaction is determined by anode material and solution type
        let anodeReactionData = null;
        // Check if the selected anode material exists as a key in anodeReactionDataCalculations
        if (anodeReactionDataCalculations[selectedAnodeMaterial]) {
             // Then check if the selected solution exists as a key under that anode material
             if (anodeReactionDataCalculations[selectedAnodeMaterial][selectedSolutionKey]) {
                 anodeReactionData = anodeReactionDataCalculations[selectedAnodeMaterial][selectedSolutionKey];
             } else {
                 // Handle cases where a specific combination might not be defined (shouldn't happen with current data)
                 console.error(`Anode reaction data not found for combination: Anode=${selectedAnodeMaterial}, Solution=${selectedSolutionKey} in Faraday 2 lookup.`);
             }
         } else {
             // Handle cases where the anode material is not defined (shouldn't happen)
             console.error(`Anode material "${selectedAnodeMaterial}" not found in anodeReactionDataCalculations.`);
         }


        // Initialize default reaction text and result text
        let cathodeReactionText = 'Cátodo (-): ---';
        let anodeReactionText = 'Ánodo (+): ---';
        let cathodeResultText = '---';
        let anodeResultText = '---';
        let cathodeProduct = null; // Stores product data (M, z, type, unit)
        let anodeProduct = null;   // Stores product data

        let cathodeProductValue = 0; // Numerical value of the product amount
        let anodeProductValue = 0;   // Numerical value of the product amount

        // Proceed with calculations only if reaction data was successfully found for both electrodes
        if (cathodeReactionData && anodeReactionData) {
             // Get reaction text and product data
             cathodeReactionText = cathodeReactionData.reaction;
             anodeReactionText = anodeReactionData.reaction;

             cathodeProduct = cathodeReactionData.product;
             anodeProduct = anodeReactionData.product;


            // --- Calculate Cathode Product Amount ---
            // Moles of product = Moles of electrons / electrons per mole of product (z)
            const moles_cathode_product = moles_e / cathodeProduct.z;
            // Calculate product amount based on its type (mass or volume)
            if (cathodeProduct.type === 'mass') {
                cathodeProductValue = moles_cathode_product * cathodeProduct.M;
            } else if (cathodeProduct.type === 'volume') {
                cathodeProductValue = moles_cathode_product * MOLAR_VOLUME_SATP; // Use SATP molar volume for gas volume
            }
            // Format the result text with 3 decimal places and the correct unit
            cathodeResultText = `${cathodeProductValue.toFixed(3)} ${cathodeProduct.unit}`;


            // --- Calculate Anode Product Amount ---
            // Moles of product = Moles of electrons / electrons per mole of product (z)
            const moles_anode_product = moles_e / anodeProduct.z;
             // Calculate product amount based on its type (mass or volume)
             if (anodeProduct.type === 'mass') {
                anodeProductValue = moles_anode_product * anodeProduct.M;
            } else if (anodeProduct.type === 'volume') {
                anodeProductValue = moles_anode_product * MOLAR_VOLUME_SATP; // Use SATP molar volume for gas volume
            }
            // Format the result text with 3 decimal places and the correct unit
            anodeResultText = `${anodeProductValue.toFixed(3)} ${anodeProduct.unit}`;

        } else { // If reaction data is missing for any electrode
             console.error(`Failed to retrieve reaction data for Solution=${selectedSolutionKey}, Anode=${selectedAnodeMaterial} in F2 calculation.`);
             cathodeResultText = 'Error'; // Indicate an error in the output display
             anodeResultText = 'Error';   // Indicate an error in the output display
        }


        // --- Update Numerical Displays ---
        // Update the span elements to display the calculated result texts
        cathodeResultSpan.textContent = cathodeResultText;
        anodeResultSpan.textContent = anodeResultText;

        // --- Update Reaction Displays ---
        // Update the paragraph elements with the reaction text (supports KaTeX)
        cathodeReactionP.innerHTML = cathodeReactionText; // Use innerHTML because text contains HTML/KaTeX
        anodeReactionP.innerHTML = anodeReactionText;     // Use innerHTML because text contains HTML/KaTeX

        // --- Update Visuals and Bubbles ---
        // Reset previous visual bars and bubbles in the section before updating
        resetSectionVisuals('faraday-2-interactive');

        // Determine max scaling values for 1F for visual representation.
        // Use the substance with the highest M/z (Ag) for max mass scale.
        const maxMassFor1F = substances['Ag1'].M / substances['Ag1'].z; // (107.868 / 1)
        // Use the substance with the highest Vm/z (H2 or Cl2) for max volume scale.
        const maxVolFor1F = MOLAR_VOLUME_SATP / substances['H2'].z; // (24.79 / 2)

        // Update Cathode Visual (uses deposited-mass-2 element in F2 HTML)
        if (cathodeProduct) { // Check if product data exists
            if (cathodeProduct.type === 'mass') {
                 // If product is mass, update the deposited-mass visual
                 updateSpecificVisual('deposited-mass-2', cathodeProductValue, maxMassFor1F, 'mass-deposited');
                 updateBubbleVisual('cathode-bubbles-2', false); // No bubbles for solid deposition
            } else if (cathodeProduct.type === 'volume') {
                 // If product is gas (volume), repurpose the deposited-mass visual or use a dedicated gas visual (using deposited-mass-2 as per HTML)
                 updateSpecificVisual('deposited-mass-2', cathodeProductValue, maxVolFor1F, 'volume-gas'); // Label it as volume-gas type for coloring/position
                 updateBubbleVisual('cathode-bubbles-2', cathodeProductValue > 0); // Turn on bubbles if gas is produced (value > 0)
            }
             // Note: If cathodeProduct does not exist, resetSectionVisuals already cleared the visual.
        }

        // Update Anode Visual (uses dissolved-mass-2 OR produced-gas-2 in F2 HTML)
        if (anodeProduct) { // Check if product data exists
             if (anodeProduct.type === 'mass') {
                 // If product is mass, update the dissolved-mass visual
                 updateSpecificVisual('dissolved-mass-2', anodeProductValue, maxMassFor1F, 'mass-dissolved');
                 // Ensure gas visual is off for this electrode if it was previously on
                 updateSpecificVisual('produced-gas-2', 0, 1, 'volume-gas');
                 updateBubbleVisual('anode-bubbles-2', false); // No bubbles for dissolution
            } else if (anodeProduct.type === 'volume') {
                 // If product is gas (volume), update the produced-gas visual
                 updateSpecificVisual('produced-gas-2', anodeProductValue, maxVolFor1F, 'volume-gas'); // Label it as volume-gas type
                 // Ensure dissolved visual is off
                 updateSpecificVisual('dissolved-mass-2', 0, 1, 'mass-dissolved');
                 updateBubbleVisual('anode-bubbles-2', anodeProductValue > 0); // Turn on bubbles if gas is produced (value > 0)
            }
             // Note: If anodeProduct does not exist, resetSectionVisuals already cleared the visuals.
        }


        // Re-render KaTeX math formulas in the reaction display elements
        reRenderKatex(['cathode-reaction-2', 'anode-reaction-2']);
    }

    // --- Faraday 3 Interactive Calculation (m = MIt / zF) ---
    // Calculates product amounts (mass or volume) based on user-adjustable current and time,
    // for a selected electrolyte and anode material.
    function calculateFaraday3() {
        // Get references to all relevant HTML elements
        const solutionSelect = document.getElementById('solution-select-3');
        const anodeSelect = document.getElementById('anode-select-3');
        const cathodeSelect = document.getElementById('cathode-select-3'); // Read for state display but not calculation logic
        const currentInput = document.getElementById('current-3');
        const timeInput = document.getElementById('time-3');

        const cathodeResultSpan = document.getElementById('cathode-result-3'); // Cathode product output
        const anodeResultSpan = document.getElementById('anode-result-3');     // Anode product output
        const anodeReactionP = document.getElementById('anode-reaction-3');     // Anode reaction display
        const cathodeReactionP = document.getElementById('cathode-reaction-3'); // Cathode reaction display

        // Get references to the span elements displaying slider values and charge
        const currentValueSpan = document.getElementById('current-value-3');
        const timeValueSpan = document.getElementById('time-value-3');
        const chargeSpan = document.getElementById('charge-3');


         // Exit the function if any crucial element is missing
         if (!solutionSelect || !anodeSelect || !cathodeSelect || !currentInput || !timeInput || !cathodeResultSpan || !anodeResultSpan || !anodeReactionP || !cathodeReactionP || !currentValueSpan || !timeValueSpan || !chargeSpan) {
             console.warn("Faraday 3 elements not fully found, skipping calculation.");
             return;
         }


        // Get selected values from the dropdowns and inputs
        const selectedSolutionKey = solutionSelect.value; // e.g., 'CuSO4', 'NaCl_conc', 'NaCl_dilute', 'H2SO4'
        const selectedAnodeMaterial = anodeSelect.value; // e.g., 'Cu', 'Inert'
        const selectedCathodeMaterial = cathodeSelect.value; // Read but not used in the main logic

        const current = parseFloat(currentInput.value);
        const timeHours = parseFloat(timeInput.value);
        const timeSeconds = timeHours * 3600; // Convert time from hours to seconds

        // Update slider value display spans
        currentValueSpan.textContent = current.toFixed(1); // Display current with 1 decimal
        timeValueSpan.textContent = timeHours.toFixed(1);   // Display time in hours with 1 decimal

        // Calculate total charge passed (Q = I * t)
        const charge = current * timeSeconds;
        // Update charge display span
        chargeSpan.textContent = charge.toFixed(0); // Display charge as an integer


        // --- Determine Reactions and Products based on selections ---
        // Cathode reaction is determined solely by the solution type
        const cathodeReactionData = reactionDataCalculations[selectedSolutionKey];

        // Anode reaction is determined by anode material and solution type
        let anodeReactionData = null;
         // Check if the selected anode material exists as a key in anodeReactionDataCalculations
        if (anodeReactionDataCalculations[selectedAnodeMaterial]) {
             // Then check if the selected solution exists as a key under that anode material
             if (anodeReactionDataCalculations[selectedAnodeMaterial][selectedSolutionKey]) {
                 anodeReactionData = anodeReactionDataCalculations[selectedAnodeMaterial][selectedSolutionKey];
             } else {
                 // Handle cases where a specific combination might not be defined
                 console.error(`Anode reaction data not found for combination: Anode=${selectedAnodeMaterial}, Solution=${selectedSolutionKey} in Faraday 3 lookup.`);
             }
         } else {
             // Handle cases where the anode material is not defined
             console.error(`Anode material "${selectedAnodeMaterial}" not found in anodeReactionDataCalculations.`);
         }


         // Initialize default reaction text and result text
        let cathodeReactionText = 'Cátodo (-): ---';
        let anodeReactionText = 'Ánodo (+): ---';
        let cathodeProductValue = 0; // Numerical value of the product amount
        let anodeProductValue = 0;   // Numerical value of the product amount
        let cathodeResultText = '---'; // Formatted result string (value + unit)
        let anodeResultText = '---';   // Formatted result string (value + unit)
        let cathodeProduct = null; // Stores product data (M, z, type, unit)
        let anodeProduct = null;   // Stores product data


        // Only calculate products if current and time are non-zero AND reaction data exists for both electrodes
        const canCalculate = current > 0 && timeSeconds > 0 && cathodeReactionData && anodeReactionData;

        if (canCalculate) {
             // Get reaction text and product data from the determined reactions
             cathodeReactionText = cathodeReactionData.reaction;
             anodeReactionText = anodeReactionData.reaction;

             cathodeProduct = cathodeReactionData.product;
             anodeProduct = anodeReactionData.product;

            // Calculate moles of electrons passed (n_e = Q / F)
            const moles_e = charge / F;

            // --- Calculate Cathode Product Amount ---
            // Moles of product = Moles of electrons / electrons per mole of product (z)
            const moles_cathode_product = moles_e / cathodeProduct.z;
            // Calculate product amount based on its type (mass or volume)
            if (cathodeProduct.type === 'mass') {
                 cathodeProductValue = moles_cathode_product * cathodeProduct.M;
            } else if (cathodeProduct.type === 'volume') {
                 cathodeProductValue = moles_cathode_product * MOLAR_VOLUME_SATP; // Use SATP molar volume for gas volume
            }
            // Format the result text with 3 decimal places and the correct unit
            cathodeResultText = `${cathodeProductValue.toFixed(3)} ${cathodeProduct.unit}`;


            // --- Calculate Anode Product Amount ---
            // Moles of product = Moles of electrons / electrons per mole of product (z)
            const moles_anode_product = moles_e / anodeProduct.z;
             // Calculate product amount based on its type (mass or volume)
             if (anodeProduct.type === 'mass') {
                 anodeProductValue = moles_anode_product * anodeProduct.M;
             } else if (anodeProduct.type === 'volume') {
                 anodeProductValue = moles_anode_product * MOLAR_VOLUME_SATP; // Use SATP molar volume for gas volume
             }
            // Format the result text with 3 decimal places and the correct unit
            anodeResultText = `${anodeProductValue.toFixed(3)} ${anodeProduct.unit}`;


        } else { // If current or time is zero or reaction data is missing
             // If reaction data exists but can't calculate (I=0 or t=0), show reaction text and 0 amount
             if (cathodeReactionData) cathodeReactionText = cathodeReactionData.reaction;
             else cathodeReactionText = 'Cátodo (-): No data'; // Fallback if data is missing

             if (anodeReactionData) anodeReactionText = anodeReactionData.reaction;
             else anodeReactionText = 'Ánodo (+): No data'; // Fallback if data is missing

             // Show 0 amount with the correct unit if product data exists, otherwise show ---
             cathodeResultText = `0.000 ${cathodeReactionData && cathodeReactionData.product ? cathodeReactionData.product.unit : ''}`;
             anodeResultText = `0.000 ${anodeReactionData && anodeReactionData.product ? anodeReactionData.product.unit : ''}`;

             cathodeProductValue = 0; // Ensure values are 0 for visuals
             anodeProductValue = 0;   // Ensure values are 0 for visuals
             cathodeProduct = cathodeReactionData ? cathodeReactionData.product : null; // Keep product data if available for visuals
             anodeProduct = anodeReactionData ? anodeReactionData.product : null;     // Keep product data if available for visuals
        }


        // --- Update Numerical Displays ---
        // Update the span elements to display the calculated result texts
        cathodeResultSpan.textContent = cathodeResultText;
        anodeResultSpan.textContent = anodeResultText;

        // --- Update Reaction Displays ---
        // Update the paragraph elements with the reaction text (supports KaTeX)
        cathodeReactionP.innerHTML = cathodeReactionText; // Use innerHTML because text contains HTML/KaTeX
        anodeReactionP.innerHTML = anodeReactionText;     // Use innerHTML because text contains HTML/KaTeX


        // --- Update Visuals and Bubbles ---
        // Reset previous visual bars and bubbles in the section before updating
        resetSectionVisuals('faraday-3-interactive');

        // Determine max scaling values for F3 based on the maximum current and time from F3 sliders
        const maxCurrentF3 = parseFloat(currentInput.max);
        const maxTimeHoursF3 = parseFloat(timeInput.max);
        const maxTimeSecondsF3 = maxTimeHoursF3 * 3600;
        const maxChargeF3 = maxCurrentF3 * maxTimeSecondsF3;

        // Max possible mass product for max charge (Ag has z=1, highest M/z)
        const maxMassProductF3 = (substances['Ag1'].M * maxChargeF3) / (substances['Ag1'].z * F);
        // Max possible volume product for max charge (H2 or Cl2 have z=2, highest Vm/z)
        const maxVolumeProductF3 = (MOLAR_VOLUME_SATP * maxChargeF3 / F) / substances['H2'].z; // Use z=2


        // Update Anode Visual (either dissolved mass or produced gas) and Bubbles
        if (anodeProduct) { // Check if product data exists
            if (anodeProduct.type === 'mass') {
                 // Update the dissolved mass visual
                 updateSpecificVisual('anode-dissolved-3', anodeProductValue, maxMassProductF3, 'mass-dissolved');
                 // Ensure gas visual is off for this electrode
                 updateSpecificVisual('anode-gas-3', 0, 1, 'volume-gas'); // Pass 0 to clear
                 updateBubbleVisual('anode-bubbles-3', false); // No bubbles for dissolution
            } else if (anodeProduct.type === 'volume') {
                 // Update the produced gas visual (using anode-gas-3 element)
                 updateSpecificVisual('anode-gas-3', anodeProductValue, maxVolumeProductF3, 'volume-gas');
                 // Ensure dissolved mass visual is off
                 updateSpecificVisual('anode-dissolved-3', 0, 1, 'mass-dissolved'); // Pass 0 to clear
                 updateBubbleVisual('anode-bubbles-3', anodeProductValue > 0); // Turn on bubbles if gas is produced
            } else {
                // If product type is unexpected, clear both visuals
                 updateSpecificVisual('anode-dissolved-3', 0, 1, 'mass-dissolved');
                 updateSpecificVisual('anode-gas-3', 0, 1, 'volume-gas');
                 updateBubbleVisual('anode-bubbles-3', false);
            }
             // Note: If anodeProduct does not exist, resetSectionVisuals already cleared the visuals.
        } else {
             // Explicitly clear visuals if no product data
             updateSpecificVisual('anode-dissolved-3', 0, 1, 'mass-dissolved');
             updateSpecificVisual('anode-gas-3', 0, 1, 'volume-gas');
             updateBubbleVisual('anode-bubbles-3', false);
        }


        // Update Cathode Visual (either deposited mass or produced gas) and Bubbles
        if (cathodeProduct) { // Check if product data exists
             if (cathodeProduct.type === 'mass') {
                 // Update the deposited mass visual
                 updateSpecificVisual('cathode-deposited-3', cathodeProductValue, maxMassProductF3, 'mass-deposited');
                 // Ensure gas visual is off for this electrode
                 updateSpecificVisual('cathode-gas-3', 0, 1, 'volume-gas'); // Pass 0 to clear
                 updateBubbleVisual('cathode-bubbles-3', false); // No bubbles for deposition
             } else if (cathodeProduct.type === 'volume') {
                 // Update the produced gas visual (using cathode-gas-3 element)
                 updateSpecificVisual('cathode-gas-3', cathodeProductValue, maxVolumeProductF3, 'volume-gas');
                  // Ensure deposited mass visual is off
                 updateSpecificVisual('cathode-deposited-3', 0, 1, 'mass-deposited'); // Pass 0 to clear
                 updateBubbleVisual('cathode-bubbles-3', cathodeProductValue > 0); // Turn on bubbles if gas is produced
             } else {
                 // If product type is unexpected, clear both visuals
                 updateSpecificVisual('cathode-deposited-3', 0, 1, 'mass-deposited');
                 updateSpecificVisual('cathode-gas-3', 0, 1, 'volume-gas');
                 updateBubbleVisual('cathode-bubbles-3', false);
             }
             // Note: If cathodeProduct does not exist, resetSectionVisuals already cleared the visuals.
        } else {
             // Explicitly clear visuals if no product data
             updateSpecificVisual('cathode-deposited-3', 0, 1, 'mass-deposited');
             updateSpecificVisual('cathode-gas-3', 0, 1, 'volume-gas');
             updateBubbleVisual('cathode-bubbles-3', false);
        }

        // Re-render KaTeX math formulas in the reaction display elements
        reRenderKatex(['cathode-reaction-3', 'anode-reaction-3']);
    }

    // --- NaCl Electrolysis Interactive App Logic ---
    // Predicts reactions based on standard potentials (E°) vs. showing actual reactions
    // based on concentration and overpotential effects for NaCl electrolysis.
    function calculateNaClInteractive() {
        // Get references to all relevant HTML elements
        const electrolyteTypeSelect = document.getElementById('nacl-electrolyte-type');
        const anodeMaterialSelect = document.getElementById('nacl-anode-material');
        const cathodeMaterialSelect = document.getElementById('nacl-cathode-material'); // Read for state display

        const conditionsSpan = document.getElementById('nacl-selected-conditions'); // Display selected conditions
        const predictedCathodeP = document.getElementById('nacl-predicted-cathode'); // Predicted cathode reaction output
        const predictedAnodeP = document.getElementById('nacl-predicted-anode');     // Predicted anode reaction output
        const actualCathodeP = document.getElementById('nacl-actual-cathode');     // Actual cathode reaction output
        const actualAnodeP = document.getElementById('nacl-actual-anode');         // Actual anode reaction output
        const explanationP = document.getElementById('nacl-explanation');         // Explanation text output

         // Exit the function if any crucial element is missing
         if (!electrolyteTypeSelect || !anodeMaterialSelect || !cathodeMaterialSelect || !conditionsSpan || !predictedCathodeP || !predictedAnodeP || !actualCathodeP || !actualAnodeP || !explanationP) {
              console.warn("NaCl interactive elements not fully found, skipping calculateNaClInteractive.");
             return;
         }

        // Get selected values from the dropdowns
        const selectedElectrolyteType = electrolyteTypeSelect.value; // 'molten', 'aqueous_conc', 'aqueous_dilute'
        const selectedAnodeMaterial = anodeMaterialSelect.value; // 'Inert', 'ActiveCu'
        const selectedCathodeMaterial = cathodeMaterialSelect.value; // 'Inert', 'ActiveCu', 'ActiveNa' (Read for display)


        // --- Update Conditions Display ---
        // Update the span element to show the currently selected conditions
        conditionsSpan.textContent = `${electrolyteTypeSelect.options[electrolyteTypeSelect.selectedIndex].text}, Ánodo: ${anodeMaterialSelect.options[anodeMaterialSelect.selectedIndex].text}, Cátodo: ${cathodeMaterialSelect.options[cathodeMaterialSelect.selectedIndex].text}`;


        // --- Determine Predicted Reactions (Based Only on E°) ---
        // Initialize prediction text variables
        let predictedCathodeText = 'Cátodo (-): ';
        let predictedAnodeText = 'Ánodo (+): ';

        // Standard Reduction Potentials (E° vs SHE) for relevant species at Cathode (-)
        // Species that can be reduced at the cathode in NaCl solutions (or molten NaCl)
        const speciesRed = [
             // Note: standardPotential['Na+'] is for aqueous Na+ -> Na(s). Molten uses Na(l) but E° is similar.
             { name: 'Na⁺', reaction_aq: '\\( \\text{Na}^+(ac) + e^- \\rightarrow \\text{Na}(s) \\)', reaction_molten: '\\( \\text{Na}^+(l) + e^- \\rightarrow \\text{Na}(l) \\)', E_red: standardPotentials['Na+'] },
             // standardPotentials['H2O_red_neutral'] is for neutral/basic water reduction, relevant for aqueous NaCl
             { name: 'H₂O', reaction_aq: '\\( 2\\text{H}_2\\text{O}(l) + 2e^- \\rightarrow \\text{H}_2(g) + 2\\text{OH}^-(ac) \\)', E_red: standardPotentials['H2O_red_neutral'] }
        ];

         // Standard Oxidation Potentials (E°ox = -E°red) for relevant species at Anode (+)
         // Species that can be oxidized at the anode in NaCl solutions (or molten NaCl)
        const speciesOx = [
            // Standard potential for Cl- oxidation
            { name: 'Cl⁻', reaction_inert: '\\( 2\\text{Cl}^-(ac) \\rightarrow \\text{Cl}_2(g) + 2e^- \\)', reaction_molten: '\\( 2\\text{Cl}^-(l) \\rightarrow \\text{Cl}_2(g) + 2e^- \\)', E_ox: standardPotentials['Cl-'] },
            // Standard potential for Water oxidation (to O2) - potential depends on pH, using acid potential here
            { name: 'H₂O', reaction_inert: '\\( 2\\text{H}_2\\text{O}(l) \\rightarrow \\text{O}_2(g) + 4\\text{H}^+(ac) + 4e^- \\)', E_ox: standardPotentials['H2O_ox'] },
             // Oxidation of anode materials (Active Anodes)
             { name: 'Cu', reaction_active: '\\( \\text{Cu}(s) \\rightarrow \\text{Cu}^{2+}(ac) + 2e^- \\)', E_ox: standardPotentials['Cu_ox'] },
             { name: 'Al', reaction_active: '\\( \\text{Al}(s) \\rightarrow \\text{Al}^{3+}(ac) + 3e^- \\)', E_ox: standardPotentials['Al_ox'] }
        ];


        // --- Prediction Logic (Based purely on Standard Potentials E°) ---
        // Cathode: Species with the most positive E°_red (least negative) will be predicted to reduce first.
        let predictedCathodeSpecies = null;

        if (selectedElectrolyteType === 'molten') {
            // In molten NaCl, only Na+ ions are present to be reduced.
             predictedCathodeSpecies = speciesRed.find(s => s.name === 'Na⁺');
             // Use the molten reaction text for the prediction display
             predictedCathodeText += `${predictedCathodeSpecies.reaction_molten} \\( E^\circ_{red} = ${predictedCathodeSpecies.E_red.toFixed(2)} \\text{ V} \\)`;

        } else { // Aqueous (conc or dilute)
             // In aqueous NaCl, both Na+ and H2O can be reduced.
             // Compare standard reduction potentials: E°(Na+/Na) = -2.71V, E°(H2O/H2) = -0.83V (at pH 7).
             const naPlusRed = speciesRed.find(s => s.name === 'Na⁺');
             const h2oRed = speciesRed.find(s => s.name === 'H₂O');
             // The species with the higher (less negative) E°red is predicted to be reduced.
             predictedCathodeSpecies = naPlusRed.E_red > h2oRed.E_red ? naPlusRed : h2oRed; // H2O wins (-0.83V > -2.71V)

             // Use the aqueous reaction text for the prediction display
             predictedCathodeText += `${predictedCathodeSpecies.reaction_aq} \\( E^\circ_{red} = ${predictedCathodeSpecies.E_red.toFixed(2)} \\text{ V} \\)`;
        }


        // Anode: Species with the most positive E°_ox (most negative E°_red) will be predicted to oxidize first.
        let predictedAnodeSpecies = null;
        const possibleAnodeOxidations = []; // Array to hold species that could be oxidized

        if (selectedElectrolyteType !== 'molten') { // Aqueous
             // On an inert anode in aqueous NaCl, Cl- and H2O can be oxidized.
             possibleAnodeOxidations.push(speciesOx.find(s => s.name === 'Cl⁻')); // Cl- oxidation
             possibleAnodeOxidations.push(speciesOx.find(s => s.name === 'H₂O')); // Water oxidation (to O2)

             // If the anode is active (e.g., Cu), the anode material itself can also be oxidized.
             // Add the active anode oxidation to the possibilities.
             if (selectedAnodeMaterial !== 'Inert') {
                 let activeAnodeOx = speciesOx.find(s => s.name === selectedAnodeMaterial);
                 if (activeAnodeOx) possibleAnodeOxidations.push(activeAnodeOx);
             }

             // Find the species with the highest standard oxidation potential (most positive E_ox).
             predictedAnodeSpecies = possibleAnodeOxidations.reduce((prev, current) => (prev.E_ox > current.E_ox ? prev : current));

             // Use the appropriate reaction text (inert or active) for the prediction display.
             let predictedAnodeReactionText = predictedAnodeSpecies.reaction_inert || predictedAnodeSpecies.reaction_active;
              predictedAnodeText += `${predictedAnodeReactionText} \\( E^\circ_{ox} = ${predictedAnodeSpecies.E_ox.toFixed(2)} \\text{ V} \\)`;


        } else { // Molten
             // In molten NaCl with an Inert anode, only Cl- ions are present to be oxidized.
             predictedAnodeSpecies = speciesOx.find(s => s.name === 'Cl⁻');
             // Use the molten reaction text for the prediction display
              predictedAnodeText += `${predictedAnodeSpecies.reaction_molten} \\( E^\circ_{ox} = ${predictedAnodeSpecies.E_ox.toFixed(2)} \\text{ V} \\)`;
        }


        // --- Determine Actual Reactions (Considering Concentration and Overpotential) ---
        let actualCathodeReactionText = null;
        let actualAnodeReactionText = null;
        let explanationText = ''; // Initialize explanation text as an empty string.

         // Actual Cathode Reaction:
         if (selectedElectrolyteType === 'molten') {
              // In molten NaCl, the actual cathode reaction is Na+ reduction to liquid Na.
              // Fetch the reaction text from reactionDataCalculations using the specific key
              actualCathodeReactionText = reactionDataCalculations.NaCl_molten_cathode.reaction;
              explanationText += '- En NaCl fundido, solo Na⁺(l) y Cl⁻(l) están presentes. La reducción de Na⁺ a Na(l) en el cátodo es la única reacción catódica posible y la que ocurre realmente.\n';
         } else { // Aqueous (conc or dilute)
             // In aqueous NaCl (regardless of concentration), water reduction is always the actual reaction at the cathode because Na+ is much harder to reduce.
              // Fetch the reaction text from reactionDataCalculations using the aqueous NaCl key (conc or dilute will point to the same H2O reduction)
              actualCathodeReactionText = reactionDataCalculations.NaCl_conc.reaction; // Using the H2O reduction text
              explanationText += '- En soluciones acuosas de NaCl, el agua se reduce en el cátodo porque tiene un potencial de reducción mucho menos negativo (-0.83 V) que el Na⁺ (-2.71 V). La reacción real es la reducción de agua a H₂(g) y OH⁻.\n';
         }


        // Actual Anode Reaction:
        if (selectedElectrolyteType !== 'molten') { // Aqueous
            if (selectedAnodeMaterial === 'Inert') {
                // Actual reaction on Inert anode in aqueous NaCl depends on concentration due to overpotential and Nernst effect.
                if (selectedElectrolyteType === 'aqueous_conc') {
                    // In concentrated NaCl, Cl- oxidation is kinetically favored.
                     actualAnodeReactionText = anodeReactionDataCalculations.Inert.NaCl_conc.reaction; // Use Cl2 text from calculations data
                     explanationText += ' Sin embargo, en el ánodo inerte con salmuera concentrada, la alta concentración de Cl⁻ y el sobrepotencial relativamente alto para la formación de O₂ hacen que la oxidación de Cl⁻ a Cl₂(g) sea cinéticamente más favorable que la oxidación del agua a O₂(g), a pesar de un E° ligeramente menos favorable para Cl₂.\n';
                } else { // aqueous_dilute
                    // In dilute NaCl, water oxidation becomes more favorable.
                     actualAnodeReactionText = anodeReactionDataCalculations.Inert.NaCl_dilute.reaction; // Use O2 text from calculations data
                     explanationText += ' Sin embargo, en el ánodo inerte con solución diluida, la baja concentración de Cl⁻ no puede competir eficazmente con la oxidación del agua a O₂(g), que se convierte en la reacción principal en el ánodo.\n';
                }
            } else { // Active Anode (e.g., Cu)
                 // If an active anode is used, the anode material itself is oxidized.
                 // Fetch the reaction text for active anode oxidation from calculations data.
                 if (anodeReactionDataCalculations[selectedAnodeMaterial] && anodeReactionDataCalculations[selectedAnodeMaterial]['CuSO4']) { // Use CuSO4 key as a generic aqueous example
                     actualAnodeReactionText = anodeReactionDataCalculations[selectedAnodeMaterial]['CuSO4'].reaction;
                     explanationText += ` Sin embargo, con un ánodo activo de ${selectedAnodeMaterial} en solución acuosa, el material del ánodo se oxida (${selectedAnodeMaterial} → ${selectedAnodeMaterial}ⁿ⁺ + ne⁻) porque es más fácilmente oxidable (su potencial de oxidación es menos negativo o positivo) que el agua o los aniones presentes.\n`;
                 } else {
                      actualAnodeReactionText = 'Anodo activo no definido para esta solución'; // Fallback text
                      explanationText += '- No se encontró información específica para este material de ánodo activo en solución acuosa. Es probable que el ánodo se disuelva si su potencial de oxidación es favorable.\n'; // More detailed fallback explanation
                 }
            }
         } else { // Molten NaCl Anode (Assume Inert based on dropdown options for molten)
             // In molten NaCl with an Inert anode, the actual anode reaction is Cl- oxidation to Cl2.
             // Fetch the reaction text from calculations data using the specific key
             actualAnodeReactionText = anodeReactionDataCalculations.NaCl_molten_anode_inert.reaction; // Use Cl2 text
             // Explanation for molten anode is typically included in the molten cathode explanation added at the start.
         }


        // --- Update Display Elements ---
        // Update the paragraph elements with the determined texts.
        if (predictedCathodeP) predictedCathodeP.innerHTML = predictedCathodeText; // Prediction uses innerHTML for KaTeX
        if (predictedAnodeP) predictedAnodeP.innerHTML = predictedAnodeText;     // Prediction uses innerHTML for KaTeX
        if (actualCathodeP) actualCathodeP.innerHTML = actualCathodeReactionText; // Actual uses innerHTML for KaTeX (and icon)
        if (actualAnodeP) actualAnodeP.innerHTML = actualAnodeReactionText;         // Actual uses innerHTML for KaTeX (and icon)
        if (explanationP) explanationP.textContent = explanationText;       // Explanation is plain text

        // Re-render KaTeX math formulas in the reaction display elements
        reRenderKatex(['nacl-predicted-cathode', 'nacl-predicted-anode', 'nacl-actual-cathode', 'nacl-actual-anode']);


        // --- Dynamic Dropdown Options ---
        // Adjust dropdown options based on the selected electrolyte state (Molten vs Aqueous)
        const anodeSelect = document.getElementById('nacl-anode-material');
        const cathodeSelect = document.getElementById('nacl-cathode-material');

        // Manage Anode options: Active Cu doesn't make sense for Molten NaCl industrial process representation.
        if (anodeSelect) {
            const activeCuOption = anodeSelect.querySelector('option[value="ActiveCu"]');
            const inertOption = anodeSelect.querySelector('option[value="Inert"]');

            if (selectedElectrolyteType === 'molten') {
                // Disable and hide ActiveCu for molten
                if (activeCuOption) {
                    activeCuOption.disabled = true;
                    activeCuOption.style.display = 'none';
                }
                // If ActiveCu was selected for molten, force selection to Inert
                 if (anodeSelect.value !== 'Inert' && inertOption) {
                     anodeSelect.value = 'Inert';
                     // Re-run the interactive calculation after changing anode to update display
                    calculateNaClInteractive();
                 }
                 // Ensure Inert option is available for molten
                 if (inertOption) {
                     inertOption.disabled = false;
                     inertOption.style.display = '';
                 }

            } else { // Aqueous (conc or dilute)
                 // Enable ActiveCu for aqueous
                 if (activeCuOption) {
                    activeCuOption.disabled = false;
                    activeCuOption.style.display = '';
                }
                // Ensure Inert option is available for aqueous
                 if (inertOption) {
                     inertOption.disabled = false;
                     inertOption.style.display = '';
                 }
            }
        }

        // Manage Cathode options: Active Na doesn't deposit from Aqueous NaCl (Na+ is not reduced). Active Cu can deposit if present.
         if (cathodeSelect) {
             const activeNaOption = cathodeSelect.querySelector('option[value="ActiveNa"]');
              const inertOption = cathodeSelect.querySelector('option[value="Inert"]');
              const activeCuOption = cathodeSelect.querySelector('option[value="ActiveCu"]');

             if (selectedElectrolyteType !== 'molten') { // Aqueous
                 // Disable and hide ActiveNa for aqueous
                 if (activeNaOption) {
                     activeNaOption.disabled = true;
                     activeNaOption.style.display = 'none';
                 }
                  // If ActiveNa was selected for aqueous, force selection to Inert
                 if (cathodeSelect.value === 'ActiveNa' && inertOption) {
                     cathodeSelect.value = 'Inert';
                     // Re-run the interactive calculation after changing cathode
                     calculateNaClInteractive();
                 }
                 // Inert and ActiveCu are possible surface types in aqueous
                  if (inertOption) { inertOption.disabled = false; inertOption.style.display = ''; }
                  if (activeCuOption) { activeCuOption.disabled = false; activeCuOption.style.display = ''; }

             } else { // Molten
                  // Enable ActiveNa for molten
                  if (activeNaOption) {
                     activeNaOption.disabled = false;
                     activeNaOption.style.display = '';
                 }
                 // Inert is also possible surface type (e.g. steel tank walls)
                  if (inertOption) { inertOption.disabled = false; inertOption.style.display = ''; }
                 // ActiveCu doesn't make much sense for Molten NaCl cathode substrate, disable it.
                 if (activeCuOption) {
                     activeCuOption.disabled = true;
                     activeCuOption.style.display = 'none';
                 }
                 // If ActiveCu was selected for molten, force selection to Inert
                  if (cathodeSelect.value === 'ActiveCu' && inertOption) {
                     cathodeSelect.value = 'Inert';
                     // Re-run the interactive calculation after changing cathode
                     calculateNaClInteractive();
                 }
             }
         }
    }


    // --- Initialize Interactives and Add Event Listeners on Page Load ---
    // This ensures the calculations run as soon as the page is ready and
    // that user interaction triggers recalculations.
    document.addEventListener('DOMContentLoaded', () => {
        // Perform initial calculations to populate the outputs on load
        calculateFaraday1();
        calculateFaraday2();
        calculateFaraday3();
        calculateNaClInteractive();

        // --- Add Event Listeners to Trigger Calculations on User Input ---

        // Faraday 1 Interactive: Listen for changes on sliders
        const currentInput1 = document.getElementById('current-1');
        const timeInput1 = document.getElementById('time-1');
        const voltageInput1 = document.getElementById('voltage-1');
        if(currentInput1) currentInput1.addEventListener('input', calculateFaraday1);
        if(timeInput1) timeInput1.addEventListener('input', calculateFaraday1);
        if(voltageInput1) voltageInput1.addEventListener('input', calculateFaraday1);

        // Faraday 2 Interactive: Listen for changes on dropdowns
        const solutionSelect2 = document.getElementById('solution-select-2');
        const anodeSelect2 = document.getElementById('anode-select-2');
        const cathodeSelect2 = document.getElementById('cathode-select-2'); // Add listener even if not used for calculation logic
         if(solutionSelect2) solutionSelect2.addEventListener('change', calculateFaraday2);
         if(anodeSelect2) anodeSelect2.addEventListener('change', calculateFaraday2);
         if(cathodeSelect2) cathodeSelect2.addEventListener('change', calculateFaraday2);

        // Faraday 3 Interactive: Listen for changes on dropdowns and sliders
        const solutionSelect3 = document.getElementById('solution-select-3');
        const anodeSelect3 = document.getElementById('anode-select-3');
        const cathodeSelect3 = document.getElementById('cathode-select-3'); // Add listener even if not used for calculation logic
        const currentInput3 = document.getElementById('current-3');
        const timeInput3 = document.getElementById('time-3');
         if(solutionSelect3) solutionSelect3.addEventListener('change', calculateFaraday3);
         if(anodeSelect3) anodeSelect3.addEventListener('change', calculateFaraday3);
         if(cathodeSelect3) cathodeSelect3.addEventListener('change', calculateFaraday3);
         if(currentInput3) currentInput3.addEventListener('input', calculateFaraday3);
         if(timeInput3) timeInput3.addEventListener('input', calculateFaraday3);

        // NaCl Interactive App: Listen for changes on dropdowns
        const naclElectrolyteTypeSelect = document.getElementById('nacl-electrolyte-type');
        const naclAnodeMaterialSelect = document.getElementById('nacl-anode-material');
        const naclCathodeMaterialSelect = document.getElementById('nacl-cathode-material'); // Add listener
         if(naclElectrolyteTypeSelect) naclElectrolyteTypeSelect.addEventListener('change', calculateNaClInteractive);
         if(naclAnodeMaterialSelect) naclAnodeMaterialSelect.addEventListener('change', calculateNaClInteractive);
         if(naclCathodeMaterialSelect) naclCathodeMaterialSelect.addEventListener('change', calculateNaClInteractive);

         // Initial KaTeX render for any math not in interactive sections (already handled by auto-render onload)
         // renderMathInElement(document.body);
    });

   </script>
</body>
</html>
